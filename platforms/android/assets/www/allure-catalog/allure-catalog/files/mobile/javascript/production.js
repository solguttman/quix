!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:d.position,width:0,zIndex:d.zIndex});if(d.radius+d.length+d.width,e(f,{left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h}),!function(a){a.renderDOM=function(){var a=document.body,b=document.head;a.innerHTML="";var c=el.createElement("div",{"class":"splashScreen",id:"splashScreen",styles:{backgroundColor:"#"+BG_COLOR}},a),d=el.createElement("div",{"class":"splashScreenTitle"},c);changeUrlWhenPubl(ASSETS_FOLDER+"/thumb.jpg",function(a){if(d){el.createElement("img",{alt:"",src:a},d);var b=el.createElement("H2",{},d);b.innerHTML=PUBLICATION_NAME}}),el.createElement("meta",{"http-equiv":"Cache-Control",content:"no-cache"},b),el.createElement("meta",{name:"HandheldFriendly",content:"True"},b),el.createElement("meta",{name:"apple-mobile-web-app-capable",content:"yes"},b),el.createElement("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"},b),el.createElement("link",{rel:"apple-touch-icon",href:ASSETS_FOLDER+"/thumb.jpg"},b);var e=el.createElement("div",{id:"mainFlow","class":"mainFlow"},a),f=el.createElement("div",{id:"topToolbar","class":"topToolbar"},e),g=(el.createElement("span",{"class":"icon fb-icon-menu",id:"tocButton"},f),el.createElement("span",{id:"cartButton","class":"icon fb-icon-empty-cart toolbar"},f),el.createElement("h3",{"class":"topToolbarLabel"},f));g.innerHTML=PUBLICATION_NAME;var h=(el.createElement("span",{"class":"icon fb-icon-help",id:"helpButton"},f),el.createElement("div",{id:"bottomToolbar","class":"bottomToolbar"},e)),i=el.createElement("div",{"class":"bottomPagerToolbar"},h),j=el.createElement("p",{"class":"bottomPagerLabel"},i);j.innerHTML='<span id="pageLabel"></span> <span id="currentPageLabel"></span> / <span id="pageCountLabel"></span>';var k=el.createElement("div",{"class":"bottomButtonsToolbar"},h),l=(el.createElement("span",{id:"thButton","class":"icon fb-icon-th"},k),el.createElement("div",{"class":"bottomButtonsGroup"},k));el.createElement("span",{id:"bmButton","class":"icon fb-icon-bookmark"},l),el.createElement("span",{id:"shareButton","class":"icon fb-icon-export"},l),el.createElement("span",{id:"searchButton","class":"icon fb-icon-search"},l)}}(this),!function(a){"use strict";function b(a){this.basePath=a||"",this.numLoads=0,this.numMods=0,this.head=document.getElementsByTagName("head")[0]}function c(a,b,c){!PUBL||DEBUG_MODE||"undefined"!=typeof c&&!c?b(a):d.getFile(a,function(a){b(a.target.responseText)})}b.prototype.load=function(a,b,d){function e(a){g(a)}var f=this;b=b||function(){},d=d||function(){},f.numLoads=0;var g=function(a){var e=document.createElement("script");e.type="text/javascript",e.charset="utf-8",e.async=!1,e.addEventListener("load",function(){f.numLoads++,f.numLoads===f.numMods&&setTimeout(function(){"[object Function]"===Object.prototype.toString.call(b)?b.call():console.log("FBRequire error: callback function is not a function. Callback:"+b)},1)}),e.addEventListener("error",function(){"[object Function]"===Object.prototype.toString.call(d)?d.call():console.log("FBRequire error: errBack function is not a function. errBack:"+b)}),c(a,function(a){e.src=a},-1===a.indexOf("static")&&-1===a.indexOf("cloudfront.net")),f.head.appendChild(e)};if("[object Array]"===Object.prototype.toString.call(a)){f.numMods=a.length;for(var h=0;h<a.length;h++)e(f.basePath+a[h]+(DEBUG_MODE?".js?"+(new Date).getTime():".js"))}else f.numMods=1,e(f.basePath+a+(DEBUG_MODE?".js?"+(new Date).getTime():".js"))},b.prototype.loadCSS=function(a,b){var d=this;this.endOfLoads=document.styleSheets.length+a.length,b=b||function(){};var e=function(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",c(a,function(a){b.href=a},-1===a.indexOf("static")),d.head.appendChild(b)},f=function(){var a=setInterval(function(){d.endOfLoads===document.styleSheets.length&&(b.call(),clearInterval(a))},20)};if("[object Array]"===Object.prototype.toString.call(a))for(var g=0;g<a.length;g++)e(a[g]+".css");else e(a+".css");f()};var d={getFile:function(a,b){"undefined"!=typeof PS&&""!==PS&&(a=a+"?password="+PS),"undefined"!=typeof USERID&&""!==USERID&&(a=a+"?loginTicket="+USERID);var c=new XMLHttpRequest;c.open("GET",a),c.onload=b,c.onerror=function(){},c.send(),c=null},getData:function(a,b){var c=function(){var a=new XMLHttpRequest;a.open("GET",this.responseText),a.onload=b,a.onerror=function(){},a.send(),a=null};d.getFile(a,c)}};if(a.changeUrlWhenPubl=c,a.fbRequire=new b,DEBUG_MODE){var e=function(){var b=new XMLHttpRequest;b.open("GET",JAVASCRIPT_FOLDER+"/!units.xml?"+Math.random(),!1);var c=[];b.onreadystatechange=function(){if(4===b.readyState){if(200!==b.status&&0!==b.status)throw"Status is "+b.status;for(var d=b.responseXML,e=d.documentElement.getElementsByTagName("Unit")[0].getElementsByTagName("Source"),f=0;f<e.length;f++){var g=e[f];c.push(JAVASCRIPT_FOLDER+"/"+g.getAttribute("FileName").replace(".js",""))}var h=function(){c.length>0&&a.fbRequire.load(c.shift(),h)};h()}},b.send(null)};"undefined"==typeof publicationData?a.fbRequire.load([ASSETS_FOLDER+"/properties"],e):e()}}(this),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.2";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return arguments.length<2||c?a[x.random(a.length-1)]:x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={},f=null==c?x.identity:B(c);return y(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};x.groupBy=C(function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),!function(a){"use strict";var b={getMaxZoom:function(a,b,c){return a=a||52e5,Math.sqrt(a/(b*c))}};b.SPLITTERS=[",",";","."," ","?","!","'",'"',"",String.fromCharCode(10),String.fromCharCode(13),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8722),String.fromCharCode(8209),String.fromCharCode(8208)],publicationData.getPageProperty=function(a,b){return"undefined"==typeof publicationData.page[a][b]?publicationData.page.defaults[b]:publicationData.page[a][b]},publicationData.getImageURL=function(a){var c=b.getNum(a),d=publicationData.getPageProperty(a,"zoomFormat");return"png"===d||"jpg"===d?ASSETS_FOLDER+"/pages/page"+c+"_i2."+d:(d=-1!==d.indexOf("jpg")?"jpg":"png",ASSETS_FOLDER+"/../common/page-substrates/page"+c+"."+d)},publicationData.getThURL=function(a){var c=b.getNum(a),d=publicationData.getPageProperty(a,"thFormat");return TH_FOLDER+"/page"+c+"_s."+d},b.getNum=function(a){var b="000"+a;return a>9&&(b="00"+a),a>99&&(b="0"+a),a>999&&(b=""+a),b},b.getPixelRatio=function(){return"undefined"==typeof window.devicePixelRatio?1:window.devicePixelRatio>1.3?2:1},b.stopScroll=function(a){Hammer(a,{prevent_default:!0}).on("drag",function(){})},b.split=function(a,b){for(var c=a.split(" "),d=[],e=0;e<c.length;e++)c[e].length>=b&&d.push(c[e]);return d},b.isSplitter=function(a){for(var b=0;b<this.SPLITTERS.length;b++)if(a==this.SPLITTERS[b])return!0;return!1},b.screening=function(a){var b=/</gi,c=function(){return"&lt;"};return a.replace(b,c)},b.chunk=function(a,b){"undefined"==typeof b&&(b=2);var c=a.match(new RegExp(".{1,"+b+"}","g"));return c||[]},b.hexToRGB=function(a){function b(a){return"#"==a.charAt(0)?a.substring(1,7):a}var c=parseInt(b(a).substring(0,2),16),d=parseInt(b(a).substring(2,4),16),e=parseInt(b(a).substring(4,6),16);return c+","+d+","+e},b.fitScreenSizes=function(a,b,c,d,e){c=c||0;var f=(d||window.innerWidth)-c,g=(e||window.innerHeight)-c,h=f/g,i=a/b,j=h>i?a*g/b:f,k=h>i?g:b*f/a;return j=Math.round(j),k=Math.round(k),{width:j,height:k,paddingTop:(g+c-k)/2,paddingLeft:(f+c-j)/2}},a.fbUtils=b}(this);var el={canvas:new Object,cTest:!1,id:function(a){return document.getElementById(a)},tag:function(a){return document.getElementsByTagName(a)[0]},tags:function(a){return document.getElementsByTagName(a)},add:function(a){return document.createElement(a)},css:function(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d=c.replace(/-(.)/g,function(a,b){return b.toUpperCase()});d="float"===d?"cssFloat":d,a.style[d]=b[c]}},del:function(a){return _.isString(a)?device.publisher.isOn?null!=document.getElementById(a)&&el.id(a).parentNode.removeChild(el.id(a)):el.id(a)&&el.id(a).parentNode.removeChild(el.id(a)):a.parentNode.removeChild(a),!0},addClass:function(a,b){var c=a.getAttribute("class");null===c||"undefined"==typeof c?a.setAttribute("class",b):c.indexOf(b)<0&&a.setAttribute("class",c+" "+b)},removeClass:function(a,b){var c=new RegExp(b,"g"),d=a.getAttribute("class");a.setAttribute("class",d.replace(c,""))},createElement:function(a,b,c,d){c=c||-1;var e=document.createElement(a);for(var f in b)b.hasOwnProperty(f)&&("styles"!=f?e.setAttribute(f,b[f]):this.css(e,b.styles));return"top"===d?-1!=c&&(_.isString(c)?document.getElementById(c).insertBefore(e,document.getElementById(c).firstChild):c.insertBefore(e,c.firstChild)):-1!=c&&(_.isString(c)?document.getElementById(c).appendChild(e):c.appendChild(e)),e},clear:function(a){_.isString(a)&&(a=a.id(a)),a.innerHTML=""}};!function(a){function b(){}b.prototype.on=function(a,b,c){var d,e=a.split(" ");if(_.isArray(e))for(var f=0,g=e.length;g>f;f++)this._events||(this._events={}),d=this._events[e[f]]||(this._events[e[f]]=[]),d.push({callback:b,context:c,ctx:c||this});else this._events||(this._events={}),d=this._events[a]||(this._events[a]=[]),d.push({callback:b,context:c,ctx:c||this});return this},b.prototype.once=function(a,b,c){var d=this,e=_.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},b.prototype.trigger=function(a){if(!this._events)return this;var b=Array.prototype.slice.call(arguments,1),c=this._events[a],d=this._events.all;return c&&this.triggerEvents(c,b),d&&this.triggerEvents(d,arguments),this},b.prototype.triggerEvents=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},b.prototype.off=function(a,b,c){var d,e,f,g,h,i,j,k;if(!this._events)return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:_.keys(this._events),h=0,i=g.length;i>h;h++)if(a=g[h],f=this._events[a]){if(this._events[a]=d=[],b||c)for(j=0,k=f.length;k>j;j++)e=f[j],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},b.prototype.set=function(a,b){return this[a]===b?this:(this[a]=b,this.trigger("change:"+a,b,this),this)},a.Events=b}(this),!function(a){"use strict";function b(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0}function c(){var c=navigator.userAgent.toLowerCase(),e=c.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],f=navigator.platform.toLowerCase();if(this.ready=!1,this.setSizes=!1,this.mainLoad=!1,this.name="",this.type=!1,this.browser={},this.os={},this.publisher={},this.lang=a.navigator.language.toLowerCase().split("-")[0],1===publicationData.locales.length)this.lang=publicationData.locales[0];else{var g=_.indexOf(publicationData.locales,this.lang);this.lang=-1===g?"en":this.lang}this.browser.name="version"===e[1]?e[3]:e[1],this.browser.name="unknown"===this.browser.name?"safari":this.browser.name,this.browser[this.browser.name]=!0;var h="ie"==e[1]&&document.documentMode;if(this.browser.version=h||parseFloat("opera"==e[1]&&e[4]?e[4]:e[2]),-1!==d()&&(this.browser={},this.browser.name="ie",this.browser.ie=!0,this.browser.version=d()),this.os.name=c.match(/ip(?:ad|od|hone)/)?"ios":c.match(/(?:msie 9)/)?"wphone":(c.match(/(?:webos|android|bada|symbian|palm|blackberry)/)||f.match(/mac|win|linux/)||["other"])[0],this.os[this.os.name]=!0,this.name=c.match(/ipad/)?"ipad":c.match(/ipod/)?"ipod":c.match(/iphone/)?"iphone":c.match(/android/)?"android":f.match(/mac|win|linux/)?"pc":"other",this.type=c.match(/ipad/)||c.match(/tablet/)?"tablet":"mobile",this.platform={},this.platform.name=c.match(/ip(?:ad|od|hone)/)?"ios":c.match(/(?:msie 9)/)?"wphone":(c.match(/(?:webos|android|bada|symbian|palm|blackberry)/)||f.match(/mac|win|linux/)||["other"])[0],this.platform[this.platform.name]=!0,this.platform.version=0,this.platform.mac){var i=c.match(/os\sx\s(\d+[\._]*\d*[\._]*\d*)/);this.platform.version="[object Array]"===Object.prototype.toString.call(i)&&i.length>1?i[1].split(/[\._]/):0}else if(this.platform.ios){var i=c.match(/os\s(\d+_*\d*_*\d*)/);this.platform.version="[object Array]"===Object.prototype.toString.call(i)&&i.length>1?i[1].split("_"):0}else if(this.platform.android){var i=c.match(/android\s(\d+\.*\d*\.*\d*)/);this.platform.version="[object Array]"===Object.prototype.toString.call(i)&&i.length>1?i[1].split("."):0}this.device={},this.device.name=c.match(/ipad/)?"ipad":c.match(/ipad/)?"ipad":c.match(/iphone/)?"iphone":c.match(/android/)?"android":f.match(/mac|win|linux/)?"pc":"other",this.device[this.device.name]=!0,this.device.version=this.platform.version[0],this.device.type=c.match(/(mobile\ssafari)|iphone|ipod/)?"mobile":"tablet";try{this.name=b("type"),this.os.name="android"==this.name?"android":"ios",this.os[this.os.name]=!0,this.type="android"==this.os.name?"mobile":"ipad"===this.name?"tablet":"mobile",this.publisher.orientation=b("orientation"),this.publisher.isOn=!0}catch(j){}if(this.os.ios||this.browser.chrome){for(var k=document.getElementsByTagName("meta"),l=0;l<k.length;l++)"viewport"==k[l].name&&document.head.removeChild(k[l]);var m="initial-scale="+1/fbUtils.getPixelRatio()+", maximum-scale="+1/fbUtils.getPixelRatio()+", user-scalable=no, minimal-ui",n=document.createElement("meta");n.name="viewport",n.content=m,document.getElementsByTagName("head")[0].appendChild(n),this._setFrame(),n=null,k=null,m=null}else{for(var k=document.getElementsByTagName("meta"),l=0;l<k.length;l++)"viewport"==k[l].name&&document.head.removeChild(k[l]);var m="initial-scale=1, maximum-scale="+1/fbUtils.getPixelRatio()+", minimum-scale="+1/fbUtils.getPixelRatio()+", user-scalable=no, target-densitydpi=device-dpi",n=document.createElement("meta");n.name="viewport",n.content=m,document.getElementsByTagName("head")[0].appendChild(n),this._setFrame(),n=null,k=null,m=null}var o=this;_.delay(function(){o.screenWidth=window.innerWidth,
o.screenHeight=window.innerHeight,o.orientation=o.getOrientation(),o.set("setSizes",!0)},100);var o=this;window.addEventListener("resize",function(){o.set("screenWidth",window.innerWidth),o.set("screenHeight",window.innerHeight)}),window.addEventListener("orientationchange",function(){o.set("screenWidth",window.innerWidth),o.set("screenHeight",window.innerHeight)}),this.on("change:screenHeight",function(){a.device.platform.ios&&setTimeout(function(){o.set("screenHeight",window.innerHeight)},1e3)},this),this.on("change:screenWidth change:screenHeight",function(){this._setFrame(),navigator.userAgent.match(/OS 8_\d/i)&&this.set("orientation",""),this.set("orientation",this.getOrientation())},this),this.on("change:setSizes change:mainLoad",function(){this.setSizes&&this.mainLoad&&this.set("ready",!0)},this),this.on("change:ready",function(){a.main()},this),e=null,f=null}function d(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var b=navigator.userAgent,c=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}return a}c.prototype=new Events,c.prototype.constructor=c,c.prototype.getOrientation=function(){return this.screenWidth<=this.screenHeight?"portrait":"landscape"},c.prototype._setFrame=function(){document.body.style.webkitTransform="translate3d(0,0,0)",navigator.userAgent.match(/iPad;.*CPU.*OS 7_\d/i)&&el.css(document.body,{height:window.innerHeight+"px"}),navigator.userAgent.match(/OS 8_\d/i)&&el.css(document.body,{height:(window.innerHeight<100?document.documentElement.clientHeight+(window.scrollY<0?window.scrollY:0):window.innerHeight)+"px"}),window.scrollTo(0,0)},a.device=new c}(this),function(a,b){"use strict";function c(){if(!d.READY){d.event.determineEventTypes();for(var a in d.gestures)d.gestures.hasOwnProperty(a)&&d.detection.register(d.gestures[a]);d.event.onTouch(d.DOCUMENT,d.EVENT_MOVE,d.detection.detect),d.event.onTouch(d.DOCUMENT,d.EVENT_END,d.detection.detect),d.READY=!0}}var d=function(a,b){return new d.Instance(a,b||{})};d.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},d.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,d.HAS_TOUCHEVENTS="ontouchstart"in a,d.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&navigator.userAgent.match(d.MOBILE_REGEX),d.EVENT_TYPES={},d.DIRECTION_DOWN="down",d.DIRECTION_LEFT="left",d.DIRECTION_UP="up",d.DIRECTION_RIGHT="right",d.POINTER_MOUSE="mouse",d.POINTER_TOUCH="touch",d.POINTER_PEN="pen",d.EVENT_START="start",d.EVENT_MOVE="move",d.EVENT_END="end",d.DOCUMENT=document,d.plugins={},d.READY=!1,d.Instance=function(a,b){var e=this;return c(),this.element=a,this.enabled=!0,this.options=d.utils.extend(d.utils.extend({},d.defaults),b||{}),this.options.stop_browser_behavior&&d.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),d.event.onTouch(a,d.EVENT_START,function(a){e.enabled&&d.detection.startDetect(e,a)}),this},d.Instance.prototype={on:function(a,b){for(var c=a.split(" "),d=0;d<c.length;d++)this.element.addEventListener(c[d],b,!1);return this},off:function(a,b){for(var c=a.split(" "),d=0;d<c.length;d++)this.element.removeEventListener(c[d],b,!1);return this},trigger:function(a,b){var c=d.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var e=this.element;return d.utils.hasParent(b.currentContentElement,e)&&(e=b.currentContentElement),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this}};var e=null,f=!1,g=!1;d.event={_bindDom:function(a,b,c){for(var d=b.split(" "),e=0;e<d.length;e++)a.addEventListener(d[e],c,!1)},onTouch:function(a,b,c){var h=this;this._bindDom(a,d.EVENT_TYPES[b],function(i){var j=i.type.toLowerCase();if(!j.match(/mouse/)||!g){(j.match(/touch/)||j.match(/pointerdown/)||j.match(/mouse/)&&1===i.which)&&(f=!0),j.match(/touch|pointer/)&&(g=!0);var k=0;f&&(d.HAS_POINTEREVENTS&&b!=d.EVENT_END?k=d.PointerEvent.updatePointer(b,i):j.match(/touch/)?k=i.touches.length:g||(k=j.match(/up/)?0:1),k>0&&b==d.EVENT_END?b=d.EVENT_MOVE:k||(b=d.EVENT_END),k||null===e?e=i:i=e,c.call(d.detection,h.collectEventData(a,b,i)),d.HAS_POINTEREVENTS&&b==d.EVENT_END&&(k=d.PointerEvent.updatePointer(b,i))),k||(e=null,f=!1,g=!1,d.PointerEvent.reset())}})},determineEventTypes:function(){var a;a=d.HAS_POINTEREVENTS?d.PointerEvent.getEvents():d.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],d.EVENT_TYPES[d.EVENT_START]=a[0],d.EVENT_TYPES[d.EVENT_MOVE]=a[1],d.EVENT_TYPES[d.EVENT_END]=a[2]},getTouchList:function(a){return d.HAS_POINTEREVENTS?d.PointerEvent.getTouchList():a.touches?a.touches:[{identifier:1,pageX:a.pageX,pageY:a.pageY,currentContentElement:a.currentContentElement}]},collectEventData:function(a,b,c){var e=this.getTouchList(c,b),f=d.POINTER_TOUCH;return(c.type.match(/mouse/)||d.PointerEvent.matchType(d.POINTER_MOUSE,c))&&(f=d.POINTER_MOUSE),{center:d.utils.getCenter(e),timeStamp:(new Date).getTime(),currentContentElement:c.currentContentElement,touches:e,eventType:b,pointerType:f,srcEvent:c,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return d.detection.stopDetect()}}}},d.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];return Object.keys(a.pointers).sort().forEach(function(c){b.push(a.pointers[c])}),b},updatePointer:function(a,b){return a==d.EVENT_END?this.pointers={}:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c={};return c[d.POINTER_MOUSE]=b.pointerType==b.MSPOINTER_TYPE_MOUSE||b.pointerType==d.POINTER_MOUSE,c[d.POINTER_TOUCH]=b.pointerType==b.MSPOINTER_TYPE_TOUCH||b.pointerType==d.POINTER_TOUCH,c[d.POINTER_PEN]=b.pointerType==b.MSPOINTER_TYPE_PEN||b.pointerType==d.POINTER_PEN,c[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},d.utils={extend:function(a,c,d){for(var e in c)a[e]!==b&&d||(a[e]=c[e]);return a},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var b=[],c=[],d=0,e=a.length;e>d;d++)b.push(a[d].pageX),c.push(a[d].pageY);return{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),e=Math.abs(a.pageY-b.pageY);return c>=e?a.pageX-b.pageX>0?d.DIRECTION_LEFT:d.DIRECTION_RIGHT:a.pageY-b.pageY>0?d.DIRECTION_UP:d.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==d.DIRECTION_UP||a==d.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){var c,d=["webkit","khtml","moz","ms","o",""];if(b&&a.style){for(var e=0;e<d.length;e++)for(var f in b)b.hasOwnProperty(f)&&(c=f,d[e]&&(c=d[e]+c.substring(0,1).toUpperCase()+c.substring(1)),a.style[c]=b[f]);"none"==b.userSelect&&(a.onselectstart=function(){return!1})}}},d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:d.utils.extend({},b),lastEvent:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);for(var b=this.current.inst.options,c=0,e=this.gestures.length;e>c;c++){var f=this.gestures[c];if(!this.stopped&&b[f.name]!==!1&&f.handler.call(f,a,this.current.inst)===!1){this.stopDetect();break}}return this.current&&(this.current.lastEvent=a),a.eventType==d.EVENT_END&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=d.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(a){var b=this.current.startEvent;if(b&&(a.touches.length!=b.touches.length||a.touches===b.touches)){b.touches=[];for(var c=0,e=a.touches.length;e>c;c++)b.touches.push(d.utils.extend({},a.touches[c]))}var f=a.timeStamp-b.timeStamp,g=a.center.pageX-b.center.pageX,h=a.center.pageY-b.center.pageY,i=d.utils.getVelocity(f,g,h);return d.utils.extend(a,{deltaTime:f,deltaX:g,deltaY:h,velocityX:i.x,velocityY:i.y,distance:d.utils.getDistance(b.center,a.center),angle:d.utils.getAngle(b.center,a.center),direction:d.utils.getDirection(b.center,a.center),scale:d.utils.getScale(b.touches,a.touches),rotation:d.utils.getRotation(b.touches,a.touches),startEvent:b}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),d.utils.extend(d.defaults,c,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}},d.gestures=d.gestures||{},d.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case d.EVENT_START:clearTimeout(this.timer),d.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==d.detection.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case d.EVENT_MOVE:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case d.EVENT_END:clearTimeout(this.timer)}}},d.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!1,doubletap_distance:20,doubletap_interval:300},handler:function(a,b){if(a.eventType==d.EVENT_END){var c=d.detection.previous,e=!1;if(a.deltaTime>b.options.tap_max_touchtime||a.distance>b.options.tap_max_distance)return;c&&"tap"==c.name&&a.timeStamp-c.lastEvent.timeStamp<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),e=!0),(!e||b.options.tap_always)&&(d.detection.current.name="tap",b.trigger(d.detection.current.name,a))}}},d.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){if(a.eventType==d.EVENT_END){if(b.options.swipe_max_touches>0&&a.touches.length>b.options.swipe_max_touches)return;(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},d.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:5,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:20,fb_lock_to_axis:!1,fb_lock_min_distance:10,fb_lock_sensitivity:100},triggered:!1,counter:0,fbDirection:"",fbLock:!1,fbNeverLock:!1,saveX:0,saveY:0,handler:function(a,b){if(d.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(b.options.drag_max_touches>0&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case d.EVENT_START:this.triggered=!1,this.counter=0,this.fbDirection="",this.fbLock=!1,this.fbNeverLock=!1;break;case d.EVENT_MOVE:if(a.distance<b.options.drag_min_distance&&d.detection.current.name!=this.name)return;d.detection.current.name=this.name,(d.detection.current.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&b.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var c=d.detection.current.lastEvent.direction;a.drag_locked_to_axis&&c!==a.direction&&(a.direction=d.utils.isVertical(c)?a.deltaY<0?d.DIRECTION_UP:d.DIRECTION_DOWN:a.deltaX<0?d.DIRECTION_LEFT:d.DIRECTION_RIGHT),this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.options.fb_lock_to_axis&&(++this.counter,!this.fbNeverLock&&this.counter<=b.options.fb_lock_min_distance&&!this.fbLock?Math.abs(a.deltaX)>b.options.fb_lock_sensitivity&&Math.abs(a.deltaY)<b.options.fb_lock_sensitivity?("v"===this.fbDirection&&(this.fbNeverLock=!0),this.fbDirection="h"):Math.abs(a.deltaX)<b.options.fb_lock_sensitivity&&Math.abs(a.deltaY)>b.options.fb_lock_sensitivity?("h"===this.fbDirection&&(this.fbNeverLock=!0),this.fbDirection="v"):Math.abs(a.deltaX)>b.options.fb_lock_sensitivity&&Math.abs(a.deltaY)>b.options.fb_lock_sensitivity?this.fbNeverLock=!0:""!==this.fbDirection&&(this.fbNeverLock=!0):this.fbNeverLock||this.fbLock||(this.fbLock=!0,this.saveY=a.deltaY,this.saveX=a.deltaX),this.fbLock&&("h"===this.fbDirection?a.deltaY=this.saveY:b.options.drag_block_vertical||(a.deltaX=this.saveX))),b.trigger(this.name,a),b.trigger(this.name+a.direction,a),(b.options.drag_block_vertical&&d.utils.isVertical(a.direction)||b.options.drag_block_horizontal&&!d.utils.isVertical(a.direction))&&a.preventDefault();break;case d.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},d.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,b){if(d.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(a.touches.length<2))switch(b.options.transform_always_block&&a.preventDefault(),a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:var c=Math.abs(1-a.scale),e=Math.abs(a.rotation);if(c<b.options.transform_min_scale&&e<b.options.transform_min_rotation)return;d.detection.current.name=this.name,this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),e>b.options.transform_min_rotation&&b.trigger("rotate",a),c>b.options.transform_min_scale&&(b.trigger("pinch",a),b.trigger("pinch"+(a.scale<1?"in":"out"),a));break;case d.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},d.gestures.Touch={name:"touch",index:-(1/0),defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){return b.options.prevent_mouseevents&&a.pointerType==d.POINTER_MOUSE?void a.stopDetect():(b.options.prevent_default&&a.preventDefault(),void(a.eventType==d.EVENT_START&&b.trigger(this.name,a)))}},d.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==d.EVENT_END&&b.trigger(this.name,a)}},"object"==typeof module&&"object"==typeof module.exports?module.exports=d:(a.Hammer=d,"function"==typeof a.define&&a.define.amd&&a.define("hammer",[],function(){return d}))}(this),window.Modernizr=function(a,b,c){function d(a){r.cssText=a}function e(a,b){return typeof a===b}function f(a,b){return!!~(""+a).indexOf(b)}function g(a,b){for(var d in a){var e=a[d];if(!f(e,"-")&&r[e]!==c)return"pfx"==b?e:!0}return!1}function h(a,b,d){for(var f in a){var g=b[a[f]];if(g!==c)return d===!1?a[f]:e(g,"function")?g.bind(d||b):g}return!1}function i(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),f=(a+" "+u.join(d+" ")+d).split(" ");return e(b,"string")||e(b,"undefined")?g(f,b):(f=(a+" "+v.join(d+" ")+d).split(" "),h(f,b,c))}var j,k,l,m="2.8.3",n={},o=b.documentElement,p="modernizr",q=b.createElement(p),r=q.style,s=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),t="Webkit Moz O ms",u=t.split(" "),v=t.toLowerCase().split(" "),w={},x=[],y=x.slice,z=function(a,c,d,e){var f,g,h,i,j=b.createElement("div"),k=b.body,l=k||b.createElement("body");if(parseInt(d,10))for(;d--;)h=b.createElement("div"),h.id=e?e[d]:p+(d+1),j.appendChild(h);return f=["&#173;",'<style id="s',p,'">',a,"</style>"].join(""),j.id=p,(k?j:l).innerHTML+=f,l.appendChild(j),k||(l.style.background="",l.style.overflow="hidden",i=o.style.overflow,o.style.overflow="hidden",o.appendChild(l)),g=c(j,a),k?j.parentNode.removeChild(j):(l.parentNode.removeChild(l),o.style.overflow=i),!!g},A=function(){function a(a,f){f=f||b.createElement(d[a]||"div"),a="on"+a;var g=a in f;return g||(f.setAttribute||(f=b.createElement("div")),f.setAttribute&&f.removeAttribute&&(f.setAttribute(a,""),g=e(f[a],"function"),e(f[a],"undefined")||(f[a]=c),f.removeAttribute(a))),f=null,g}var d={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return a}(),B={}.hasOwnProperty;l=e(B,"undefined")||e(B.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return B.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=y.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(y.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(y.call(arguments)))};return d}),w.hashchange=function(){return A("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},w.csstransforms=function(){return!!i("transform")},w.csstransforms3d=function(){var a=!!i("perspective");return a&&"webkitPerspective"in o.style&&z("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(b,c){a=9===b.offsetLeft&&3===b.offsetHeight}),a},w.csstransitions=function(){return i("transition")},w.localstorage=function(){try{return localStorage.setItem(p,p),localStorage.removeItem(p),!0}catch(a){return!1}};for(var C in w)l(w,C)&&(k=C.toLowerCase(),n[k]=w[C](),x.push((n[k]?"":"no-")+k));return n.addTest=function(a,b){if("object"==typeof a)for(var d in a)l(a,d)&&n.addTest(d,a[d]);else{if(a=a.toLowerCase(),n[a]!==c)return n;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(o.className+=" "+(b?"":"no-")+a),n[a]=b}return n},d(""),q=j=null,n._version=m,n._prefixes=s,n._domPrefixes=v,n._cssomPrefixes=u,n.hasEvent=A,n.testProp=function(a){return g([a])},n.testAllProps=i,n.testStyles=z,n.prefixed=function(a,b,c){return b?i(a,b,c):i(a,"pfx")},n}(this,this.document),function(a,b,c){function d(a,c){this.wrapper="string"==typeof a?b.querySelector(a):a,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var d in c)this.options[d]=c[d];this.translateZ=this.options.HWCompositing&&f.hasPerspective?" translateZ(0)":"",this.options.useTransition=f.hasTransition&&this.options.useTransition,this.options.useTransform=f.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?f.ease[this.options.bounceEasing]||f.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}var e=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)},f=function(){function d(a){return g===!1?!1:""===g?a:g+a.charAt(0).toUpperCase()+a.substr(1)}var e={},f=b.createElement("div").style,g=function(){for(var a,b=["t","webkitT","MozT","msT","OT"],c=0,d=b.length;d>c;c++)if(a=b[c]+"ransform",a in f)return b[c].substr(0,b[c].length-1);return!1}();e.getTime=Date.now||function(){return(new Date).getTime()},e.extend=function(a,b){for(var c in b)a[c]=b[c]},e.addEvent=function(a,b,c,d){a.addEventListener(b,c,!!d)},e.removeEvent=function(a,b,c,d){a.removeEventListener(b,c,!!d)},e.momentum=function(a,b,d,e,f,g){var h,i,j=a-b,k=c.abs(j)/d;return g=void 0===g?6e-4:g,h=a+k*k/(2*g)*(0>j?-1:1),i=k/g,e>h?(h=f?e-f/2.5*(k/8):e,j=c.abs(h-a),i=j/k):h>0&&(h=f?f/2.5*(k/8):0,j=c.abs(a)+h,i=j/k),{destination:c.round(h),duration:i}};var h=d("transform");return e.extend(e,{hasTransform:h!==!1,hasPerspective:d("perspective")in f,hasTouch:"ontouchstart"in a,hasPointer:navigator.msPointerEnabled,hasTransition:d("transition")in f}),e.isBadAndroid=/Android /.test(a.navigator.appVersion)&&!/Chrome\/\d/.test(a.navigator.appVersion),e.extend(e.style={},{transform:h,transitionTimingFunction:d("transitionTimingFunction"),transitionDuration:d("transitionDuration"),transitionDelay:d("transitionDelay"),transformOrigin:d("transformOrigin")}),e.hasClass=function(a,b){var c=new RegExp("(^|\\s)"+b+"(\\s|$)");return c.test(a.className)},e.addClass=function(a,b){if(!e.hasClass(a,b)){var c=a.className.split(" ");c.push(b),a.className=c.join(" ")}},e.removeClass=function(a,b){if(e.hasClass(a,b)){var c=new RegExp("(^|\\s)"+b+"(\\s|$)","g");a.className=a.className.replace(c," ")}},e.offset=function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return{left:b,top:c}},e.preventDefaultException=function(a,b){for(var c in b)if(b[c].test(a[c]))return!0;return!1},e.extend(e.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),e.extend(e.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(a){return a*(2-a)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(a){return c.sqrt(1- --a*a)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(a){var b=4;return(a-=1)*a*((b+1)*a+b)+1}},bounce:{style:"",fn:function(a){return(a/=1)<1/2.75?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}},elastic:{style:"",fn:function(a){var b=.22,d=.4;return 0===a?0:1==a?1:d*c.pow(2,-10*a)*c.sin(2*(a-b/4)*c.PI/b)+1}}}),e.tap=function(a,c){var d=b.createEvent("Event");d.initEvent(c,!0,!0),d.pageX=a.pageX,d.pageY=a.pageY,a.target.dispatchEvent(d)},e.click=function(a){var c,d=a.target;/(SELECT|INPUT|TEXTAREA)/i.test(d.tagName)||(c=b.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!0,a.view,1,d.screenX,d.screenY,d.clientX,d.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),c._constructed=!0,d.dispatchEvent(c))},e}();d.prototype={version:"5.1.1",_init:function(){this._initEvents()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(a){a.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(a){if(!(1!=f.eventType[a.type]&&0!==a.button||!this.enabled||this.initiated&&f.eventType[a.type]!==this.initiated)){!this.options.preventDefault||f.isBadAndroid||f.preventDefaultException(a.target,this.options.preventDefaultException)||a.preventDefault();var b,d=a.touches?a.touches[0]:a;this.initiated=f.eventType[a.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=f.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,b=this.getComputedPosition(),this._translate(c.round(b.x),c.round(b.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=d.pageX,this.pointY=d.pageY,this._execEvent("beforeScrollStart")}},_move:function(a){if(this.enabled&&f.eventType[a.type]===this.initiated){this.options.preventDefault&&a.preventDefault();var b,d,e,g,h=a.touches?a.touches[0]:a,i=h.pageX-this.pointX,j=h.pageY-this.pointY,k=f.getTime();if(this.pointX=h.pageX,this.pointY=h.pageY,this.distX+=i,this.distY+=j,e=c.abs(this.distX),g=c.abs(this.distY),!(k-this.endTime>300&&10>e&&10>g)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=e>g+this.options.directionLockThreshold?"h":g>=e+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)a.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);j=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)a.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);i=0}i=this.hasHorizontalScroll?i:0,j=this.hasVerticalScroll?j:0,b=this.x+i,d=this.y+j,(b>0||b<this.maxScrollX)&&(b=this.options.bounce?this.x+i/3:b>0?0:this.maxScrollX),(d>0||d<this.maxScrollY)&&(d=this.options.bounce?this.y+j/3:d>0?0:this.maxScrollY),this.directionX=i>0?-1:0>i?1:0,this.directionY=j>0?-1:0>j?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(b,d),k-this.startTime>300&&(this.startTime=k,this.startX=this.x,this.startY=this.y)}}},_end:function(a){if(this.enabled&&f.eventType[a.type]===this.initiated){this.options.preventDefault&&!f.preventDefaultException(a.target,this.options.preventDefaultException)&&a.preventDefault();var b,d,e=(a.changedTouches?a.changedTouches[0]:a,f.getTime()-this.startTime),g=c.round(this.x),h=c.round(this.y),i=c.abs(g-this.startX),j=c.abs(h-this.startY),k=0,l="";if(this.isInTransition=0,this.initiated=0,this.endTime=f.getTime(),!this.resetPosition(this.options.bounceTime))return this.scrollTo(g,h),this.moved?this._events.flick&&200>e&&100>i&&100>j?void this._execEvent("flick"):(this.options.momentum&&300>e&&(b=this.hasHorizontalScroll?f.momentum(this.x,this.startX,e,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:g,duration:0},d=this.hasVerticalScroll?f.momentum(this.y,this.startY,e,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:h,duration:0},g=b.destination,h=d.destination,k=c.max(b.duration,d.duration),this.isInTransition=1),g!=this.x||h!=this.y?((g>0||g<this.maxScrollX||h>0||h<this.maxScrollY)&&(l=f.ease.quadratic),void this.scrollTo(g,h,k,l)):void this._execEvent("scrollEnd")):(this.options.tap&&f.tap(a,this.options.tap),this.options.click&&f.click(a),void this._execEvent("scrollCancel"))}},_resize:function(){var a=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){a.refresh()},this.options.resizePolling)},resetPosition:function(a){var b=this.x,c=this.y;return a=a||0,!this.hasHorizontalScroll||this.x>0?b=0:this.x<this.maxScrollX&&(b=this.maxScrollX),!this.hasVerticalScroll||this.y>0?c=0:this.y<this.maxScrollY&&(c=this.maxScrollY),b==this.x&&c==this.y?!1:(this.scrollTo(b,c,a,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=f.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(a,b){this._events[a]||(this._events[a]=[]),this._events[a].push(b)},off:function(a,b){if(this._events[a]){var c=this._events[a].indexOf(b);c>-1&&this._events[a].splice(c,1)}},_execEvent:function(a){if(this._events[a]){var b=0,c=this._events[a].length;if(c)for(;c>b;b++)this._events[a][b].apply(this,[].slice.call(arguments,1))}},scrollBy:function(a,b,c,d){a=this.x+a,b=this.y+b,c=c||0,this.scrollTo(a,b,c,d)},scrollTo:function(a,b,c,d){d=d||f.ease.circular,this.isInTransition=this.options.useTransition&&c>0,!c||this.options.useTransition&&d.style?(this._transitionTimingFunction(d.style),this._transitionTime(c),this._translate(a,b)):this._animate(a,b,c,d.fn)},scrollToElement:function(a,b,d,e,g){if(a=a.nodeType?a:this.scroller.querySelector(a)){var h=f.offset(a);h.left-=this.wrapperOffset.left,h.top-=this.wrapperOffset.top,d===!0&&(d=c.round(a.offsetWidth/2-this.wrapper.offsetWidth/2)),e===!0&&(e=c.round(a.offsetHeight/2-this.wrapper.offsetHeight/2)),h.left-=d||0,h.top-=e||0,h.left=h.left>0?0:h.left<this.maxScrollX?this.maxScrollX:h.left,h.top=h.top>0?0:h.top<this.maxScrollY?this.maxScrollY:h.top,b=void 0===b||null===b||"auto"===b?c.max(c.abs(this.x-h.left),c.abs(this.y-h.top)):b,this.scrollTo(h.left,h.top,b,g)}},_transitionTime:function(a){a=a||0,this.scrollerStyle[f.style.transitionDuration]=a+"ms",!a&&f.isBadAndroid&&(this.scrollerStyle[f.style.transitionDuration]="0.001s")},_transitionTimingFunction:function(a){this.scrollerStyle[f.style.transitionTimingFunction]=a},_translate:function(a,b){this.options.useTransform?this.scrollerStyle[f.style.transform]="translate("+a+"px,"+b+"px)"+this.translateZ:(a=c.round(a),b=c.round(b),this.scrollerStyle.left=a+"px",this.scrollerStyle.top=b+"px"),this.x=a,this.y=b},_initEvents:function(b){var c=b?f.removeEvent:f.addEvent,d=this.options.bindToWrapper?this.wrapper:a;c(a,"orientationchange",this),c(a,"resize",this),this.options.click&&c(this.wrapper,"click",this,!0),this.options.disableMouse||(c(this.wrapper,"mousedown",this),c(d,"mousemove",this),c(d,"mousecancel",this),c(d,"mouseup",this)),f.hasPointer&&!this.options.disablePointer&&(c(this.wrapper,"MSPointerDown",this),c(d,"MSPointerMove",this),c(d,"MSPointerCancel",this),c(d,"MSPointerUp",this)),f.hasTouch&&!this.options.disableTouch&&(c(this.wrapper,"touchstart",this),c(d,"touchmove",this),c(d,"touchcancel",this),c(d,"touchend",this)),c(this.scroller,"transitionend",this),c(this.scroller,"webkitTransitionEnd",this),c(this.scroller,"oTransitionEnd",this),c(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var b,c,d=a.getComputedStyle(this.scroller,null);return this.options.useTransform?(d=d[f.style.transform].split(")")[0].split(", "),b=+(d[12]||d[4]),c=+(d[13]||d[5])):(b=+d.left.replace(/[^-\d.]/g,""),c=+d.top.replace(/[^-\d.]/g,"")),{x:b,y:c}},_animate:function(a,b,c,d){function g(){var m,n,o,p=f.getTime();return p>=l?(h.isAnimating=!1,h._translate(a,b),void(h.resetPosition(h.options.bounceTime)||h._execEvent("scrollEnd"))):(p=(p-k)/c,o=d(p),m=(a-i)*o+i,n=(b-j)*o+j,h._translate(m,n),void(h.isAnimating&&e(g)))}var h=this,i=this.x,j=this.y,k=f.getTime(),l=k+c;this.isAnimating=!0,g()},handleEvent:function(a){switch(a.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(a);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(a);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(a);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(a);break;case"wheel":case"DOMMouseScroll":
case"mousewheel":this._wheel(a);break;case"keydown":this._key(a);break;case"click":a._constructed||(a.preventDefault(),a.stopPropagation())}}},d.utils=f,"undefined"!=typeof module&&module.exports?module.exports=d:a.IScroll=d}(window,document,Math),!function(a){"use strict";function b(){var a=1;_.each(publicationData.page,function(b,c){"defaults"!==c&&(this[a]={number:a,wide:publicationData.page[c].wide,caption:publicationData.page[c].wide?a+"-"+(a+1):a,id:parseInt(c)},a++,publicationData.page[c].wide&&(this[a]={number:a,wide:publicationData.page[c].wide,caption:publicationData.page[c].wide?a-1+"-"+a:a,id:parseInt(c)},a++))},this),this.pageCount=a-1}function c(a){return"undefined"==typeof pageTable[a]?void(this.number=this.caption=this.wide=this.position=!1):(this.number=a,this.id=pageTable[a].id,this.caption=pageTable[a].caption||"",this.wide=pageTable[a].wide||!1,void(this.position=a%2===0?"left":"right"))}a.Page=c,a.pageTable=new b}(this),!function(a){function b(){this.pages={},this.on("content:loaded",this._insertPage,this)}b.prototype=new Events,b.prototype.constructor=b,b.prototype._insertPage=function(b){this.pages[b]=a.loadBuffer,this.trigger("loaded:"+b,this.pages[b],b)},b.prototype.load=function(a){if("undefined"!=typeof this.pages[a])return void this.trigger("loaded:"+a,this.pages[a],a);var b="000"+a;a>9&&(b="00"+a),a>99&&(b="0"+a),a>999&&(b=""+a),fbRequire.load([ASSETS_FOLDER+"/pages/ios/page"+b])},a.vectorLoader=new b,a.fakeLoadComplete=function(a){vectorLoader.trigger("content:loaded",a)}}(this),!function(a){"use strict";function b(a){switch(a=a||publicationData.type){case"catalog":this.portrait="fitScreen",this.landscape="tablet"!==device.type?"fitWidth":"fitScreen",this.widePageTablet=1,this.widePageMobile=.5,this.zoomLevel=1,this.zoomSave=!1,this.field=!0;break;case"magazine":this.portrait="fitScreen",this.landscape="tablet"!==device.type?"fitWidth":"fitScreen",this.widePageTablet=1,this.widePageMobile=.5,this.zoomLevel=1,this.zoomSave=!1,this.field=!0;break;case"book":this.portrait="fitScreen",this.landscape="tablet"!==device.type?"fitWidth":"fitScreen",this.widePageTablet=1,this.widePageMobile=1,this.zoomLevel=1,this.zoomSave=!0,this.field=!0;break;case"document":this.portrait="fitScreen",this.landscape="tablet"!==device.type?"fitWidth":"fitScreen",this.widePageTablet=1,this.widePageMobile=1,this.zoomLevel=1,this.zoomSave=!0,this.field=!0;break;case"photo_album":this.portrait="fitScreen",this.landscape="fitScreen",this.widePageTablet=1,this.widePageMobile=1,this.zoomLevel=1,this.zoomSave=!1,this.field=!1;break;case"presentation":this.portrait="fitScreen",this.landscape="fitScreen",this.widePageTablet=1,this.widePageMobile=1,this.zoomLevel=1,this.zoomSave=!1,this.field=!0;break;default:this.portrait="fitScreen",this.landscape="tablet"!==device.type?"fitWidth":"fitScreen",this.widePageTablet=1,this.widePageMobile=1,this.zoomLevel=1,this.zoomSave=!1,this.field=!0}}b.prototype.getFit=function(){return device.screenWidth>device.screenHeight?this.landscape:this.portrait},b.prototype.getWideFactor=function(){return"tablet"===device.type?this.widePageTablet:this.widePageMobile},b.prototype.getRect=function(a,b,e){var f=publicationData.getPageProperty(a,"width"),g=publicationData.getPageProperty(a,"height"),h=publicationData.size.width,i=publicationData.size.height,j=this.zoomSave?this.zoomLevel:1,k=this.getWideFactor();a===pageMediator.currentPage.id&&(j=this.zoomLevel),"undefined"!=typeof b&&(j=b),publicationData.page[a].wide&&(f*=k,h=2*h*k);var l,m,n={};return"undefined"!=typeof e?(l=c(h,i,1,e.width,e.height),l.height=publicationData.page[a].wide&&"tablet"!==device.type?l.height/2:l.height,f=publicationData.page[a].wide&&"tablet"!==device.type?2*f:f,m=c(f,g,1,l.width,l.height),n.pageWidth=l.width,n.pageHeight=l.height,n.ratio=m.ratio,n.contentWidth=m.width,n.contentHeight=m.height,n.padding=[(n.pageHeight-n.contentHeight)/2,(l.width-n.contentWidth)/2],publicationData.page[a].wide?(n.thPageWidth=n.pageWidth,n.thPageHeight=2*n.pageHeight,n.thPadding=[(n.thPageHeight-n.pageHeight)/2,0]):(n.thPageWidth=n.pageWidth,n.thPageHeight=n.pageHeight,n.thPadding=[0,0]),this.field||(n.thPageWidth=n.pageWidth,n.thPageHeight=n.pageHeight,n.thPadding=[(n.thPageHeight-n.contentHeight)/2,(n.thPageWidth-n.contentWidth)/2],n.pageWidth=n.contentWidth,n.pageHeight=n.contentHeight,n.padding=[0,0])):this.field?(l="fitScreen"===this.getFit()||"ipad"===device.name&&publicationData.page[a].wide?c(h,i,j):d(h,i,j),l.width=publicationData.page[a].wide&&"tablet"!==device.type?2*l.width:l.width,f=publicationData.page[a].wide&&"tablet"!==device.type?2*f:f,m=c(f,g,1,l.width,l.height),n.pageWidth=l.width,n.pageHeight=l.height,n.ratio=m.ratio,n.contentWidth=m.width,n.contentHeight=m.height,n.padding=[(n.pageHeight-n.contentHeight)/2,(l.width-n.contentWidth)/2]):(m="fitScreen"===this.getFit()?c(f,g,j):d(f,g,j),n.pageWidth=n.contentWidth=m.width,n.pageHeight=n.contentHeight=m.height,n.padding=[0,0],n.ratio=m.ratio),n},b.prototype.setZoomLevel=function(a){var b=this.getRect(pageMediator.currentPage.id,1);this.zoomLevel=a.width/b.pageWidth,this.zoomLevel=this.zoomLevel<1?1:this.zoomLevel},b.prototype.resetZoomLevel=function(){this.zoomSave||(this.zoomLevel=1)};var c=function(a,b,c,d,e){var f=d||window.innerWidth,g=e||window.innerHeight-2,h=f/g,i=a/b,j=h>i?a*g/b:f,k=h>i?g:b*f/a;return j=Math.round(j*c),k=Math.round(k*c),{width:j,height:k,ratio:j/a}},d=function(a,b,c){var d=window.innerWidth,e=d,f=b*d/a;return e=Math.round(e*c),f=Math.round(f*c),{width:e,height:f,ratio:e/a}};a.bookModel=new b}(this),!function(a){var b={init:function(){switch(device.browser.name){case"safari":this.browserPrefix="webkit";break;case"firefox":this.browserPrefix="Moz";break;case"opera":this.browserPrefix="O";break;case"ie":this.browserPrefix="ms";break;case"chrome":this.browserPrefix="webkit"}var a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};this.transEndEventName=Modernizr.prefixed("transition")?a[Modernizr.prefixed("transition")]:!1},translate:function(a,b,c,d){b=b||"0",c=c||"0",d=d||"0",b+="",c+="",d+="",-1===b.indexOf("%")&&(b+="px"),-1===c.indexOf("%")&&(c+="px"),-1===d.indexOf("%")&&(d+="px"),a.style[this.browserPrefix+"Transform"]=Modernizr.csstransforms3d?"translate3d("+b+","+c+","+d+")":"translate("+b+", "+c+")"},origin:function(a,b,c){a.style[this.browserPrefix+"TransformOrigin"]=b+"px "+c+"px"},transition:function(a,b,c){c="-"+this.browserPrefix.toLowerCase()+"-"+c||"",a.style[this.browserPrefix+"Transition"]=c+" "+b+"ms"},duration:function(a,b){a.style[this.browserPrefix+"TransitionDuration"]=b+"ms"},delay:function(a,b){a.style[this.browserPrefix+"TransitionDelay"]=b+"ms"},animation:function(a,b,c){a.style[this.browserPrefix+"Animation"]=b+" "+c+"ms"},perspective:function(a,b){a.style[this.browserPrefix+"Transform"]="perspective("+b+")"},scale:function(a,b,c){a=a||0,b=b||0,c=c||0,el.style[this.browserPrefix+"Transform"]=Modernizr.csstransforms3d?"scale3d("+a+","+b+","+c+")":"scale("+a+","+b+")"},rotate:function(a,b,c,d,e){c=c||0,d=d||0,e=e||0,a.style[this.browserPrefix+"Transform"]=Modernizr.csstransforms3d?"rotate3d("+c+","+d+","+e+","+b+")":"rotate("+b+")"},backfaceVisibility:function(a,b){a.style[this.browserPrefix+"BackfaceVisibility"]=b},boxShadow:function(a,b){a&&(a.style[this.browserPrefix+"BoxShadow"]=b)},getTransform:function(a){return a.style[this.browserPrefix+"Transform"]},transform:function(a,b,c){a.style[this.browserPrefix+"TransformOrigin"]="0px 0px",a.style[this.browserPrefix+"Transform"]="translate3d("+b+"px,"+c+"px,0px)"},getParseTranslate:function(a){var b=a.style[this.browserPrefix+"Transform"],c=/-*\d+(?=px)|\d+\%/gi,d=b.match(c);return null==d&&(d=[0,0,0]),{x:d[0],y:d[1],z:d[2]}},changeOnlyScale:function(a,b,c,d){var e=/translate3d\([A-Za-z0-9_, ]*\)/i,f=a.style[this.browserPrefix+"Transform"].match(e);null===f&&(f=""),a.style[this.browserPrefix+"Transform"]=f+" scale3d("+b+","+c+","+d+")"}};a.html5Lib=b,html5Lib.init()}(this),!function(a){"use strict";function b(){var a=1;if("undefined"!=typeof publicationData.restoreSession&&publicationData.restoreSession)try{a=localStorage.getItem("lastPage"+publicationData.ident)||1}catch(b){console.log(b)}this.previousPage=new Page(a-1),this.currentPage=new Page(1*a),this.pagingType=publicationData.rtlMode?"rtl":"ltr",this.pageCount=pageTable.pageCount,this.on("change:page",function(a){try{localStorage.setItem("lastPage"+publicationData.ident,a.number)}catch(b){console.log(b)}},this)}b.prototype=new Events,b.prototype.constructor=b,b.prototype.tapLeft=function(){this.timing=200,this._changePageNumber("ltr"===this.pagingType?this.currentPage.number-(this.currentPage.wide&&this.currentPage.number%2!=0?2:1):this.currentPage.number+(this.currentPage.wide&&this.currentPage.number%2===0?2:1))},b.prototype.tapRight=function(){this.timing=200,this._changePageNumber("ltr"===this.pagingType?this.currentPage.number+(this.currentPage.wide&&this.currentPage.number%2===0?2:1):this.currentPage.number-(this.currentPage.wide&&this.currentPage.number%2!=0?2:1))},b.prototype.slideToLeft=function(){this.timing=200,this.tapRight()},b.prototype.slideToRight=function(){this.timing=200,this.tapLeft()},b.prototype.goToPage=function(a,b){return this.timing="undefined"==typeof b?200:b,a=parseInt(a),_.isNumber(a)&&this._changePageNumber(a),this},b.prototype._changePageNumber=function(a){if(0===a||a>this.pageCount)return this;if(!pageTable[a].wide||a%2===0||a-1!==this.currentPage.number){var b="ltr"===this.pagingType?a<this.currentPage.number?"right":"left":a<this.currentPage.number?"left":"right";return this.previousPage=this.currentPage,this.currentPage=new Page(a),this.trigger("change:page",this.currentPage,this.timing,b),this}},b.prototype.checkSlide=function(a){var b=this.currentPage.number%2===0&&this.currentPage.wide?parseInt(this.currentPage.number)+2:parseInt(this.currentPage.number)+1;return"rtl"===this.pagingType?"right"===a&&1===this.currentPage.number?!1:"left"===a&&b>this.pageCount?!1:!0:"left"===a&&1===this.currentPage.number?!1:"right"===a&&b>this.pageCount?!1:!0},a.pageMediator=new b}(this),!function(a){"use strict";function b(a,b,c,d){var e,f,g,h,i="R"==a[1];i?(e=a[2]/10,f=a[3]/10,g=a[4]/1e3,h=a[5]/10):(e=a[1]/10,f=a[2]/10,g=a[3]/1e3,h=a[4]/10);var j=c+(d-1),k=0===c?0:b[c-1]/10,l=b[j]/10-k;this.y=f,this.x=e+k-(i?l:0),this.width=l,this.height=h,this.angle=g,this.ratatePadding=k-(i?l:0)}function c(a,b,c){if(this.contentLoaded=!1,this.isFirstLoadBook=c||!1,el.clear(a),this.page="current"===b?pageMediator.currentPage:new Page("left"===b?"rtl"===pageMediator.pagingType?pageMediator.currentPage.number+(pageMediator.currentPage.wide?2:1):pageMediator.currentPage.number-(pageMediator.currentPage.wide?2:1):"rtl"===pageMediator.pagingType?pageMediator.currentPage.number-(pageMediator.currentPage.wide?2:1):pageMediator.currentPage.number+(pageMediator.currentPage.wide?2:1)),this.page.number<1||this.page.number>pageTable.pageCount)return this.container=el.createElement("div",{id:"stopSlide",styles:{width:"100%",height:"100%",position:"absolute","background-size":"cover"}},a),this;this.rect=bookModel.getRect(this.page.id);var d=publicationData.getPageProperty(this.page.id,"BGColor");if(this.container=el.createElement("div",{"data-wide":publicationData.page[this.page.id].wide?"true":"false",styles:{width:this.rect.pageWidth+"px",height:this.rect.pageHeight+"px",position:"absolute",overflow:"hidden","background-repeat":"no-repeat","background-origin":"padding-box","background-size":(100*this.rect.contentWidth/this.rect.pageWidth).toFixed()+"% "+(100*this.rect.contentHeight/this.rect.pageHeight).toFixed()+"%","background-position":"center center","background-color":d}},a),!publicationData.page[this.page.id].stub){this.once("contentLoad:start",this._showPreloader,this),this.once("contentLoad:loaded",this._hidePreloader,this),this.trigger("contentLoad:start");var e=this,f=function(a,b){(b||!e.contentLoaded)&&el.css(e.container,{"background-image":'url("'+a+'")'})};changeUrlWhenPubl(publicationData.getThURL(this.page.id),f),this.on("contentLoad:loaded",f,this);var g=function(a){var b=new Image;b.onload=function(){e.contentLoaded=!0,e.trigger("contentLoad:loaded",a,!0),b=null},b.src=a};return changeUrlWhenPubl(publicationData.getImageURL(this.page.id),g),-1!==publicationData.getPageProperty(this.page.id,"zoomFormat").indexOf("js")&&this._placeVectorText(),this._placeLinks(),this.once("contentLoad:loaded",this._placeECommerce,this),this.once("contentLoad:loaded",this._placeVideos,this),this.once("contentLoad:loaded",function(){workspace.searchActive&&this._turnOnSearchHightlights.call(this,workspace.searchQuery)},this),this.on("highlight:loaded",this._placeSearchItem,this),workspace.on("searchHighlight:on",this._turnOnSearchHightlights,this),workspace.on("searchHighlight:off",this._turnOffSearchHightlights,this),this}}c.prototype=new Events,c.prototype.constructor=c,c.prototype.resize=function(a){if(!(this.page.number<1||this.page.number>pageTable.pageCount)){a=a||!1,this.rect=bookModel.getRect(this.page.id);var b=a?this.container.parentNode:!1;if(a){var c=this.container.cloneNode(!1);el.clear(c),c.id="new",html5Lib.transition(c,0),el.css(c,{width:this.rect.pageWidth+"px",height:this.rect.pageHeight+"px","background-size":(100*this.rect.contentWidth/this.rect.pageWidth).toFixed()+"% "+(100*this.rect.contentHeight/this.rect.pageHeight).toFixed()+"%","background-position":"center center"}),b.insertBefore(c,this.container),this.container=c,c=null}else{if(this.rect.pageWidth===this.container.getBoundingClientRect().width||this.rect.pageHeight===this.container.getBoundingClientRect().height)return!0;el.clear(this.container),html5Lib.transition(this.container,0),el.css(this.container,{width:this.rect.pageWidth+"px",height:this.rect.pageHeight+"px"})}return workspace.searchActive&&this._turnOnSearchHightlights(workspace.searchQuery),-1!==publicationData.getPageProperty(this.page.id,"zoomFormat").indexOf("js")&&this._placeVectorText(),this._placeECommerce(),this._placeVideos(),this._placeLinks(),!0}},c.prototype.isBlock=function(a,b){var c=pageMediator.currentPage.id,d=bookModel.getRect(c,bookModel.zoomLevel),e=(a-d.padding[1])/d.ratio,f=(b-d.padding[0])/d.ratio;if("undefined"!=typeof publicationData.page[c].blocks)for(var g=0,h=publicationData.page[c].blocks.length;h>g;g++){var i=publicationData.page[c].blocks[g];if(e>=i.rect[0]&&e<=i.rect[0]+i.rect[2]&&f>=i.rect[1]&&f<=i.rect[1]+i.rect[3]){var j={rect:[]};return j.rect[0]=i.rect[0]*d.ratio-5*fbUtils.getPixelRatio(),j.rect[1]=i.rect[1]*d.ratio,j.rect[2]=i.rect[2]*d.ratio+10*fbUtils.getPixelRatio(),j.rect[3]=i.rect[3]*d.ratio,j.rect[0]+=d.padding[1],j.rect[1]+=d.padding[0],this.resultBlockStore===c+"-"+g?(this.resultBlockStore="",!1):(this.resultBlockStore=c+"-"+g,workspace.trigger("zoom:block","Book",pageMediator.currentPage.number),j)}}return this.resultBlockStore="",!1},c.prototype._placeVectorText=function(){if(-1===publicationData.getPageProperty(this.page.id,"format").indexOf("js-")){var a=this,b=function(b,c){c===this.page.id&&_.each(b,function(b){var c=b[1].split(","),d=el.createElement("div",{"class":"vectorTextEl",styles:{fontFamily:c[0],fontWeight:"undefined"==typeof c[1]?"normal":c[1],fontSize:b[6]*a.rect.ratio+"px",color:b[7],top:b[4]*a.rect.ratio+"px",left:b[5]*a.rect.ratio+"px"}},a.container);html5Lib.origin(d,0,0),html5Lib.rotate(d,b[8]+"rad",0,0,1),d.textContent=b[0]})};vectorLoader.once("loaded:"+this.page.id,b,this),vectorLoader.load(this.page.id)}},c.prototype._clear=function(){el.clear(this.container)},c.prototype._placeLinks=function(){if("undefined"!=typeof publicationData.page[this.page.id].links){for(var a=publicationData.page[this.page.id].links,b=0,c=a.length;c>b;b++){var d=a[b],e=el.createElement("a",{href:"undefined"==typeof d.page?d.urls[0]:"#"+_.find(pageTable,function(a){return a.id===d.page}).number,"class":"vectorLinks",target:"undefined"==typeof d.page?d.target:"_self",styles:{top:(this.rect.padding[0]+d.y*this.rect.ratio-1).toFixed()+"px",left:(this.rect.padding[1]+d.x*this.rect.ratio-1).toFixed()+"px",width:(d.width*this.rect.ratio+2).toFixed()+"px",height:(d.height*this.rect.ratio+2).toFixed()+"px",backgroundColor:publicationData.linkcolor,zIndex:d.zindex}},this.container);html5Lib.rotate(e,0,0,1,d.angle+"rad"),this._setLinksEvents(e,!0),d=null}a=null}},c.prototype._setLinksEvents=function(b,c){c=c||!1;var d=!1;if(a.device.platform.ios?(b.addEventListener("touchstart",function(){d?event.preventDefault():event.stopPropagation(),c&&(d||el.css(b,{opacity:.6}))}),b.addEventListener("touchmove",function(){if(!d){c&&el.css(b,{opacity:"0"}),d=!0;var a=document.createEvent("TouchEvent");a.initTouchEvent("touchstart",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,event.touches,event.targetTouches,event.changedTouches,event.scale,event.rotation,null),event.target.dispatchEvent(a),a=null,event.preventDefault()}}),b.addEventListener("touchend",function(){d&&(event.preventDefault(),d=!1),c&&el.css(b,{opacity:0})}),b.addEventListener("touchcancel",function(){d&&(event.preventDefault(),d=!1),c&&el.css(b,{opacity:0})})):Hammer(b,{prevent_default:!0}).on("tap",function(){event.stopPropagation(),b.click()}),c){var e=function(){a.publicationData.linkHighlightOnPageFlip&&(_.delay(function(){html5Lib.animation(b,"linksLight",1e3)},500),_.delay(function(){html5Lib.animation(b,"",0)},2e3))};this.on("slideAnimation:end",function(){this.contentLoaded&&e()},this),this.once("contentLoad:loaded",e,this)}},c.prototype._placeECommerce=function(){if("undefined"!=typeof publicationData.page[this.page.id].shopItems)for(var b=publicationData.page[this.page.id].shopItems,c=publicationData.size.width/800,d=(36*c*this.rect.ratio).toFixed(),e=0,f=b.length;f>e;e++){var g=b[e];g.useGlobal&&_.extend(g,publicationData.shopInfo.cartIconGlobals);var h=(g.width*this.rect.ratio).toFixed(),i=(g.height*this.rect.ratio).toFixed(),j=(this.rect.padding[0]+g.y*this.rect.ratio).toFixed(),k=(this.rect.padding[1]+g.x*this.rect.ratio).toFixed();if("Window"===g.onClickAction)var l="#"+this.page.number+"/"+g.id;else var l=productsBD[g.id].url;var m=el.createElement("a",{"class":"eCommerceLink",href:l,styles:{top:j+"px",left:k+"px",width:h+"px",height:i+"px",zIndex:g.zindex}},this.container);html5Lib.rotate(m,0,0,1,g.angle+"rad"),this._setLinksEvents(m);var n=d*(g.priceScale/100),o=-1!==g.position.indexOf("top")?0:-1!==g.position.indexOf("bottom")?g.height*this.rect.ratio-n:(g.height*this.rect.ratio-n)/2,p=-1!==g.position.indexOf("bottom")?0:-1!==g.position.indexOf("top")?g.height*this.rect.ratio-n:(g.height*this.rect.ratio-n)/2,q=el.createElement("span",{styles:{width:h-n/2+"px",height:-1!==g.position.indexOf("bottom")||-1!==g.position.indexOf("top")?i-n/2+"px":i+"px",display:"block","float":-1===g.position.indexOf("left")?"left":"right",overflow:"hidden",borderRadius:"4px",backgroundColor:"rgba("+fbUtils.hexToRGB(g.priceTagColor)+", "+g.priceTagColorAlpha+")"}},m);if(el.createElement("span",{"class":"ecRound fb-icon-empty-cart",styles:{top:o.toFixed()+"px",bottom:p.toFixed()+"px",left:-1!==g.position.indexOf("left")?"0px":"auto",right:-1!==g.position.indexOf("right")?"0px":"auto",width:n+"px",height:n+"px",lineHeight:(.86*n).toFixed()+"px",borderRadius:(n/2).toFixed()+"px",border:(n/15).toFixed()+"px solid #fff",backgroundColor:g.circleColor,color:g.basketColor,fontSize:(.5*n).toFixed()+"px",boxShadow:"0 0 "+(n/10).toFixed()+"px #999"}},m),g.tagVisible){var r=el.createElement("span",{styles:{width:"100%",display:"block",color:g.priceColor,fontSize:(c*this.rect.ratio*12*(g.priceScale/100)).toFixed()+"px",overflow:"hidden",textAlign:"center","float":"right"}},q);g.showTitle&&(r.textContent=productsBD[g.id].name);var s=el.createElement("span",{styles:{width:"100%",display:"block",fontSize:(c*this.rect.ratio*14*(g.priceScale/100)).toFixed()+"px",marginTop:(c*this.rect.ratio*2*(g.priceScale/100)).toFixed()+"px",textAlign:"center"}},r);s.textContent=a.currency.Format(productsBD[g.id].price),function(a,b){_.defer(function(){el.css(a,{marginTop:((b-a.getBoundingClientRect().height)/2).toFixed()+"px"})})}(r,i-n/2)}else q.style.opacity=0}},c.prototype._placeVideos=function(){if("undefined"!=typeof publicationData.page[this.page.id].videos){var a=this;_.forEach(publicationData.page[this.page.id].videos,function(b){var c=el.createElement("div",{"class":"vectorVideo",styles:{top:(a.rect.padding[0]+b.y*a.rect.ratio).toFixed()+"px",left:(a.rect.padding[1]+b.x*a.rect.ratio).toFixed()+"px",width:(b.width*a.rect.ratio).toFixed()+"px",height:(b.height*a.rect.ratio).toFixed()+"px",zIndex:b.zindex}},a.container);if(html5Lib.rotate(c,0,0,1,b.angle+"rad"),b.showImage){var d=function(a){el.css(c,{backgroundColor:"#000",backgroundImage:"url("+a+")"})};changeUrlWhenPubl(COMMON_FOLDER+"/pages-content/"+b.imageUri,d)}var e=(b.height*a.rect.ratio).toFixed()>50?.35*(b.height*a.rect.ratio).toFixed():.8*(b.height*a.rect.ratio).toFixed();el.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABDCAYAAAAoCNNNAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RENDMjEyQkZENEQwMTFFMDg0N0M5RkRBMUU2NDQ2RUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RENDMjEyQzBENEQwMTFFMDg0N0M5RkRBMUU2NDQ2RUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEQ0MyMTJCREQ0RDAxMUUwODQ3QzlGREExRTY0NDZFQiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEQ0MyMTJCRUQ0RDAxMUUwODQ3QzlGREExRTY0NDZFQiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PktdS6EAAA9LSURBVHja1FsJUFRXFv0Nza7smwhNUEERl4xLKQpqJEaNuJRLpLQiTjQaFMPIOKkkjqYmExNKJaGME51xNzhqRkl0EHViTJStwkDcAEVBREB2Gmi6gaah5zzmvvbbLkHoRvKqbv3+v7v/f+/8+8499/73JUIXm1ar7exPXWCTYYNhg2DD6TjbmtNnNewGfWbbfFge7BKsSjBCk0gkj+4bCYjRsIWwWaKBd/U62eh0Ij6egGUZC4judFDf+sCiYTlaI7X29vbctra2P9K1hO7YY8AYwCPsYJGwaJjjk37b3NysyM3NLb5z547i5s2bLWlpaa3s2snJyewkkqCgIFN2ysDAQDN/f38LX1/fPgEBAZ5WVlZ9nnJtOQD5QiqV7sBufW+YGsthW4kHHmllZWXFZ86cKT58+HATBtzxF1gbWTuZloz3hZkJmWlwcLDZkiVLbGfNmtXfy8ur3xP6UN3S0vK+paXlvhcCBDrgg80RWKD4uEajaU5KSsqOiYmpS09PF2iwGlgrEaKaPrfS8XYChjVTAkAKMyMzJzODt5hv2LDBJTQ01N8cTe+6GXV1dcucnZ3zegwIgMBI8ABM57atra2qhISEG+vXr2+AJwg0yBY2K2BNZBwEPnityCsEkTdIRKBwMKzILPv162e5fft2lwULFgRYWFhYivqlVCgUb9vZ2R3TdiKkdQsInD+WuEDXUlJSrsF9K4uLiwUaKBt0I0xJQKgJmLYuzkJT8hIGCBu4DbsJmCrWhw4d8n7llVeGin+sUql22djYRDJuNTgQOKk5ecESfqyhoaH6zTffvHr69GktDVQFU5BxD2gTDNtMRR7Sl9mcOXNs9+/fP9rJyclRBMbJ+Pj4ZatWrVIZDAiAwC5+ijRBR7ty5UpOSEhIqVwuF2jQjLkbyAvU5PLGbCYECPMOWwcHB7vz588PGTt27GD+A6VS+UNkZGTogQMHmg0FRBw2UXx/165dyWvWrGkmL2CDr6NtixE8oDMeYsHAgNnHxcV5RkVFTeRfVlVV7Xd1dY3AGNTdAgInWIHNXr6/Y8eOFFxIRYNmAMiJDzQi0uvpJiEOYeTt8OWXX3rDEybxL6Fd/uTn5xeHsWi6BAT+GITNDzwfuHTp0tUpU6ZU0lSoJWt6AV7wLO9g3OF4+fLlkdAgozrid3u7JiMjYz7CbxLG1PZcQOAPMmwyuVAqKioqHDJkSD4UYjMlQTUEglboXY2Nx8ra2topJydn6ktoFN7rvvvuu0lvvPFGDo8mnQWCSUHmEQJicy3kbhbCo5oAqCJS7G0giMdk4+Pj43r16tVQW1tbB4pyV6Ax2JRRMp2hD4TJU3ghiO+Hh4dfAQhtFBlqKUx2CoSNGzcOeQFAsL6pCgsLayIiIi7wgwDkd1lZWVFErk+cV2IQWCz+N8014eLFizc++OCDBgKhioix05yAubp20aJFXgUFBeUwZQ+D0Xbjxo3W6dOnSyC++rODkOBjIcVPvv7667X6N1OiB8RfsNnMPiOZUcK90iCZmQeU07RofU4l+hERlvbChQtZK1asuFBSUtLSg4CYyWQy59u3by+FHGeaQ8jOzt43fPjwaAr5j08NluNTOt3Rjh49mgsQNCKxpOmy+jExkbz22mtj8vLy/rBz586xyJkkPQSE5v79+/Vnz55N4QcQShejLzLKYx73CFZUwSaWWLbF29v7MoBgADwgMJ47THKP0G/l5eXVmzZtOrN37957PRFWMRb7/Pz8lVKptCNJS01N/VtQUNCfSQs95hEr+efExMSbAKGVPEFlaK3g7u7uvGfPnnCQV9ikSZOcjAxEG8K/EoPXeQWi4FwqIkkfAQIgjEY48ecHt23bViPKItXG6uGoUaMGg5AjTp48GeLm5mZuRDDUMTExt/mOvb2956effjqZBwWxRyzmBxAqy9LT09UEQpOxEyhTtPnz5weB0N6NjY0dbaTLtJ87d66xurr6Lj8AnphLOYpE7BEz+Q+QVhdTLqE0pjfoN8R5m+jo6NB79+69HRYW5mkMr/jpp590VXCITga6A08hTJh2wLQYxn9w/PjxBiqoNL+IPALE5oGItSItLW3hsGHD+hiSK+Lj48v4jpOTkycI04dPD+YRU/mXTWjJyclqIki18AIbkqSAzMzMd9H5yQ4ODlJDnPPUqVMqRESFSDUH64DQaDQ6krx+/XoJiabm7ugGQzWIILOlS5dOgSpd9+GHHw41hK6AoLvOdzw9PX2ouCNlU0OXDyDWKkQV596SXgvwCNstW7YsAqH+ft68ef26Mz1KS0sr+I6Hh4eMSn5mJuAHHdK5ublKIspWoRc2X19f2bfffrsKcj10wIABVl05B/KPav7Z1dXVnTzCHOrXxI1/gTnZJDwsuffaFhISMjonJycKynTC88p1kHAj/2xtbc28wZp7hC3/AqGLP3xpE3p5s7S0tEASNw2qcU1UVJRvZ/8HvtEFAYDIUnLLDo4AEDaiYmeb8PAJ1G+iof/marXampKoX/WOyspK3U02MzOzIB1hKn1CHv+bAEKpVGp27Nhx9+OPP2YlxEaa64pOeHP7E2oyEil7VMa9AuShlcvl2t4OAgjzwZo1awqQxTbTwDrNE8hpdL+FJ6lJS5mYtLe36wQGmNikNwPwyy+/1CFbzUBukgsQGqk8UCk8rKP+qicPHjzYVASErkjEBJVuac7o0aMthW4sFTBWq6ioaIYH5KB/WVC+/FkK63cZAcH1z6968/jx43Wc2NjYyMFrl2J+FUDBdSzvGTFiRF/K0U16Q+SA4m/bvXt30ebNm4vQ6VbSOAryhEahC0/XxowZ4yQizmr6v5YBccvOzq7ji4EDB9r1FiCSkpIqkI0W5OXl8SxYSQDwh8xdSgH69+/vLgqlZVxFS8G+uoKFv78/k5wZxKQvRF3eunVLsW7dujyoxzrqg4oqZbxa1qkp8LTm4uLysh4QHXmVCS54mX/B1iy9+uqrVsITnncYu9XW1qrfe++9W7gZGehTDXlAtYgHGujudRmExYsXS6GkdVPjyJEjtzi4JqtXry5TqVT5/MsFCxY4CXoVXmM2kHX7nj17ijAt07dt21ZMHaslAFiCVEd3rdva5q233nIREXA58g45Ad7K7ry6vr4+lf9g9uzZflxtGRuEH3/8sQqR4OdVq1bdqaurU9KgKwiEWuqkwbgqODh4nCj5KiCAO+qyDAhNdnb2NyIykU2ePNlaEFV4Dd2Q0yjheVemTp16HY0/N6kkAPgTNYNyVGhoqCmm/ki+Hx8fn0XEy8DWcM3ggPB0zcbGxovtnDt37tLMmTMzqUNdbvrPNRQKRevWrVvvxsTElGJKaIj9eTjkJQCjyHtkq75Dhw7tWPpUU1NT6ezs/Fd8zIZdg8k5KTbhLv1LlOaO9/DwsDbU9GCP/I4fP14K5Zr+ySef3AcGnAfKyeSCESvmMplMAhKey/fPnz+fKSLjJkEUHVo2bdr0d7ZMkGdlX331lY/wcNF4l1tGRkZFYGBgRlhY2M3q6mouizkP1AhGeICk306cOCHj+RRkddOGDRvSCHw5eaEOCC0SmfLc3Nzj/M8zZswI9vb27lYoxQUTx40blwIw5DQFqkQ80GlZ3J02aNAgCdSkzhvOnj2bWlZWViOS5lpBz/XbwBNFIJWlpqam5lKp1By6vHnfvn1lXVVx6enpCvKqZnLDOuHhmqueStQC7O3tOx4csSf88+bNOwbNworUt6lP7YLe3daASe+mpqb+Q5SgTF65cqVDN7iCr7LhPKDqyVrH+vXrLeDVC/n+4cOH/5Ofn8+88QFxlO6G6GeaTEjJ4DqJ7u7uQ4jpS+FeR5GgqLrgxnyhuVbo4aVG6L9QUlLCvJu9LMMeZRaANHfjYxFzFNh9cYjWn//si6rY2NiP2NIAdqBv37794SWBXdQV+uute6xBn4zjILDF8hBtCUTUxcRRrfplqsdUb1pamtzPz0+LtLxjLZWjo6MM4ec+2Lde6L2LyMSZq9vIkSPD+D5u7D937drFOOEecYNceNbSIXGRGOaTmZn5BSTwdBJH7TjZvrVr15b1ZjAOHDhgv3z58kh+k1NSUi5BWrN1YaUkngoxlubOLjhlx23R/HGiuOHDh+s0ekJCwkHI4/u9EQzmCVDE74jyiZ8ROhOgHapJRbL3ORqetLzwWWU5xh/Obm5uI8ARccgOA/gXpaWlP+ACaeXl5b2i2s2IkXGCi4vLDH6sqKgoBzfwMMi+ngDIZeHyaQtOnyWW2B/kSFdvQhluALpZosQsBJI8PCIiwvpFgxAZGWmB6LBMDAKEYQaBwHQMyzLvsLE86x2OzhRqWUhlD17ZNHl/4sSJU8RfFhYWJk6bNu1KQUFBj3oHU4xI40d4enrO0xNxFydMmJBEmoWtkLnJ1CxAeCRKPI9HiEMqE0Q3g4KCtsTFxe3loZU1Hx+f0Nu3b68DSC+x5MbYALBrYLAydk0xCCxEfv755/sBwllSr3cIhHJ9ELrqEWLPcGU3Y/bs2YE7d+58B53y1ku7GzCFEjdu3Hg3MTHRoIkUqyd89tlnLw0bNmy28P9XLHUNXJW/bNmyb77//vtaCo1sOrCqW+XTQOjuy21MVLFleQyAgQincxGq5lhaWj7GFU1NTdeQbP13+/bt5V0FhQ0eiZs7pP4YCwuLlx/T72p148GDB0+vXr36Ksn5CgKBqcda/Xc0DAkEn07s+YcHmxkQWn5bt24NBU9MFL91p1ePqJTL5Vfv3r37ICcnpz45OVmJxmoUGl5UtbGxkSDe2wQEBNgNGDDAAyJuJDrr9sS52tqqunjx4mUQZTpyBxUpRqYTCimPUBjl5banTCkL8g5W1ZKBK2Rw3RC0Mc7Ozi7G4AeAWQ6CzIiOjs5EeGym4koV5Q3FlEi1GP11Rz0+YCdj6o0VPNjA+1N0cQwPDx+Cu/zy2LFj/bsLChs8Uunsr7/+OvfQoUMPqIijFFW6SwkMpfgNnR4FQnRSRqR9yEPciFRZ+m4Dze+ycOHCgYjrbl5eXo4eHh7OUqnUFAD1F5+vpqamBMzfBt1SAV1QA4FUcezYsZJr164pKV3mHiCnokoFgdHYmahgNCCeQabWxCEMCCfa9qX8xZx+I6VcwFTUB/G74xoyNQGgIABqaKsgnWCwAo+x4r5EePiiqjVNn760tSJQ+OvOJiIly1+b5q9SK0Uld5Xw8MVarTE6bOzG3/U2Fx6+/G4qMjEQbSLj67n4UkejJnn/E2AAVQ3PcVSa0qgAAAAASUVORK5CYII=",styles:{position:"absolute",top:"50%",left:"50%",width:e+"px",height:e+"px",margin:-e/2+"px 0 0 "+-e/2+"px"}},c),Hammer(c,{prevent_default:!0}).on("tap",function(){event.stopPropagation(),a._playVideo.call(a,b.type,b.id)})})}},c.prototype._playVideo=function(a,b){var c=el.createElement("div",{"class":"blackOutVideo"},document.body),d=fbUtils.fitScreenSizes(1600,900,device.screenHeight/10),e=el.createElement("iframe",{"class":"videoFrame",type:"text/html",width:d.width+"px",height:d.height+"px",frameBorder:"0",styles:{"z-index":"99999999",margin:d.paddingTop+"px 0 0 "+d.paddingLeft+"px"}},c);Hammer(e,{prevent_default:!1}).on("tap",function(){event.stopPropagation()});var f=function(){var a=fbUtils.fitScreenSizes(1600,900,device.screenHeight/10);e.width=a.width+"px",e.height=a.height+"px",el.css(e,{margin:a.paddingTop+"px 0 0 "+a.paddingLeft+"px"})};device.on("change:orientation",f,this),Hammer(c,{prevent_default:!0}).on("tap",function(){event.stopPropagation(),device.off("change:orientation",f,this),el.del(event.target)}),"youtube"===a?(e.className="youtube-player",e.src="http://www.youtube.com/embed/"+b+"?autoplay=1&html5=1"):e.src="http://player.vimeo.com/video/"+b+"?title=0&amp;byline=0&amp;portrait=0&amp;color=da4541"},c.prototype._placeSearchItem=function(a){var b=el.createElement("div",{"class":"searchItemHighlight",styles:{position:"absolute",top:(this.rect.padding[0]+a.y*this.rect.ratio-1).toFixed()+"px",left:(this.rect.padding[1]+a.x*this.rect.ratio-1).toFixed()+"px",width:(a.width*this.rect.ratio+2).toFixed()+"px",height:(a.height*this.rect.ratio+2).toFixed()+"px",opacity:.6,backgroundColor:publicationData.search.color}},this.container);html5Lib.origin(b,(-a.ratatePadding*this.rect.ratio).toFixed(),0),html5Lib.rotate(b,a.angle+"rad",0,0,1)},c.prototype._turnOffSearchHightlights=function(){this._clear(),-1!==publicationData.getPageProperty(this.page.id,"zoomFormat").indexOf("js")&&this._placeVectorText(),this._placeECommerce(),this._placeVideos(),this._placeLinks()},c.prototype._turnOnSearchHightlights=function(a){this._turnOffSearchHightlights();var c=this,d=function(){var d=this.responseText.split("\n");a=a.toLowerCase()||"",a=fbUtils.split(a,0);for(var e=1,f=d.length;f>e;e++)for(var g=d[e],h=0,i=0,j=a.length;j>i;i++){var k=a[i],l=g.split(String.fromCharCode(2));if(k.length<publicationData.search.lim){var m=void 0!=d[e-1]?d[e-1].split(String.fromCharCode(2))[0]:"",n=d[e].split(String.fromCharCode(2))[0]||"",o=void 0!=d[e+1]?d[e+1].split(String.fromCharCode(2))[0]:"",p=m+" "+n,q=n+" "+o,r=a[i-1]||"",s=a[i],t=a[i+1]||"",u=r+" "+s,v=s+" "+t,w=!1;""!=r&&-1!=p.toLowerCase().indexOf(u)&&(w=!0),""!=t&&-1!=q.toLowerCase().indexOf(v)&&(w=!0)}else w=!0;if(-1!=(h=l[0].toLowerCase().indexOf(k))&&w){var x=g.split(String.fromCharCode(4));if(x.length>1){for(var y=[],z=[],A=0,B=x.length;B>A;A++)y[A]=x[A].split(String.fromCharCode(2)),A>0&&y[A].unshift(y[0][0]),z[A]=y[A][5].split(String.fromCharCode(3));for(var C=h,D=h+k.length,E=0,F=y.length;F>E;E++)if(z[E].length<=C)C-=z[E].length,D-=z[E].length;else{if(D>z[E].length){var G=z[E].length;D-=z[E].length}else{var G=D;D=0}C>0&&(G-=C);var H=new b(y[E],z[E],C,G);C=0,c.trigger("highlight:loaded",H)}}else{var z="R"==l[1]?l[6].split(String.fromCharCode(3)):l[5].split(String.fromCharCode(3)),H=new b(l,z,h,k.length);c.trigger("highlight:loaded",H)}}}},e=new XMLHttpRequest;e.onload=d,e.onerror=function(){};var f=function(a){e.open("GET",a),e.send()};changeUrlWhenPubl(ASSETS_FOLDER+"/search/search"+fbUtils.getNum(this.page.id)+".xml",f)},c.prototype._showPreloader=function(){var a=el.createElement("div",{id:"pagePreloader","class":"pagePreloader"},this.container),b={lines:13,length:15,width:7,radius:16,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"};new Spinner(b).spin(a)},c.prototype._hidePreloader=function(){el.del("pagePreloader")},a.ontent=c}(this),!function(a){"use strict";function b(){function a(a,b){this.x=a,this.y=b}this.MAX_RESOLUTION=15e6*fbUtils.getPixelRatio(),this.mainContainer=el.id("mainFrame"),this.zoomAnimationProcess=!1,this.globalWidth=device.screenWidth,this.globalHeight=device.screenHeight,this.maxPullSize=this.globalWidth/7,this.currentPageCorner=new a(0,0),this.leftPageCorner=new a(0,0),this.rightPageCorner=new a(0,0),this.contentCorner=new a(0,0),this.leftContentCorner=new a(0,0),this.rightContentCorner=new a(0,0),this.contentCornerStore=new a(0,0),this.currentPageCornerStore=new a(0,0),this._newWrapper("current"),this.currentContentObject.trigger("content:show"),
this._newWrapper("right"),this._newWrapper("left"),device.on("change:orientation",function(){this._orientationChange.call(this)},this),this._bindDom(),this.on("slideAnimation:end",function(){this.currentContentObject.trigger("content:show")},this),Hammer(el.id("mainFrame"),{stop_browser_behavior:!0,prevent_default:!0}).on("swipeleft",function(a){"wrapper"===a.target.className&&pageMediator.slideToLeft()}),Hammer(el.id("mainFrame"),{stop_browser_behavior:!0,prevent_default:!0}).on("swiperight",function(a){"wrapper"===a.target.className&&pageMediator.slideToRight()}),this.on("zoomAnimation:start",function(){this.zoomAnimationProcess=!0},this),this.on("zoomAnimation:end",function(){this.zoomAnimationProcess=!1},this)}b.prototype=new Events,b.prototype.constructor=b,b.prototype._orientationChange=function(){this.refresh.call(this);var a=this.currentContentElement.getBoundingClientRect();(this.globalWidth>a.width||bookModel.zoomLevel<1.05)&&(bookModel.zoomLevel=1,this.currentContentObject.resize()),this.leftContentObject.resize(),this.rightContentObject.resize(),this._initSizes(0)},b.prototype._startRender=function(a){this.contentCornerStore.x=this.contentCorner.x,this.contentCornerStore.y=this.contentCorner.y,this.currentPageCornerStore.x=this.currentPageCorner.x,this.currentPageCornerStore.y=this.currentPageCorner.y,this.trigger("slideAnimation:start"),this._render(a)},b.prototype._render=function(a,b){b=b||0,a&&(this.contentCorner.x=this.contentCornerStore.x+a.deltaX,this.contentCorner.y=this.contentCornerStore.y+a.deltaY);var c=this.contentCorner.x-this.currentPageCornerStore.x,d=this.contentCorner.y-this.currentPageCornerStore.y;this.deltaHeight<0?(this.contentCorner.y=Math.abs(this.deltaHeight)/2,this.currentPageCorner.y=0):d>0?(a||(this.contentCorner.y=this.currentPageCorner.y),this.contentCorner.y=this.currentPageCorner.y+this.contentCorner.y/3):Math.abs(d)>this.deltaHeight?(a||(this.contentCorner.y=this.currentPageCorner.y-this.deltaHeight),this.contentCorner.y=this.currentPageCorner.y-this.deltaHeight+(this.contentCorner.y+this.deltaHeight)/3):this.currentPageCorner.y=this.currentPageCornerStore.y,this.deltaWidth<0?(this.currentPageCorner.x=this.contentCorner.x-Math.abs(this.deltaWidth)/2,this.contentCorner.x=Math.abs(this.deltaWidth)/2):c>0?(this.currentPageCorner.x=this.contentCorner.x,this.contentCorner.x=0):Math.abs(c)>this.deltaWidth?(this.currentPageCorner.x=this.contentCorner.x+this.deltaWidth,this.contentCorner.x=-this.deltaWidth):this.currentPageCorner.x=this.currentPageCornerStore.x,this.leftPageCorner.x=this.currentPageCorner.x-this.globalWidth,this.rightPageCorner.x=this.currentPageCorner.x+this.globalWidth,this.leftPageCorner.y=this.currentPageCorner.y,this.rightPageCorner.y=this.currentPageCorner.y,this._setStyles(b)},b.prototype._stopRender=function(a,b,c){b="undefined"==typeof b?200:b,c=c||!1;var d=this;if("stop"!==c&&(this.currentPageCorner.x<0&&Math.abs(this.currentPageCorner.x)>this.maxPullSize||"left"===c)){if(!c&&!pageMediator.checkSlide("right"))return void this._render(!1,b);this._animationEnd=function(a){c||(d.fireTrigger=!0,pageMediator.slideToLeft()),d._goToLeft.call(d,a),d.currentContentObject.trigger("slideAnimation:end"),d.trigger("slideAnimation:end")},html5Lib.transEndEventName&&("android"!==device.name||device.browser.chrome)?this.currentContainerElement.addEventListener(html5Lib.transEndEventName,this._animationEnd):_.delay(this._animationEnd,b),this.contentCorner.x=-(this.globalWidth+this.deltaWidth),this.deltaWidth<0&&(this.contentCorner.x+=this.deltaWidth/2)}else if("stop"!==c&&(this.currentPageCorner.x>0&&Math.abs(this.currentPageCorner.x)>this.maxPullSize||"right"===c)){if(!c&&!pageMediator.checkSlide("left"))return void this._render(!1,b);this._animationEnd=function(a){c||(d.fireTrigger=!0,pageMediator.slideToRight()),d._goToRight.call(d,a),d.currentContentObject.trigger("slideAnimation:end"),d.trigger("slideAnimation:end")},html5Lib.transEndEventName&&("android"!==device.name||device.browser.chrome)?this.currentContainerElement.addEventListener(html5Lib.transEndEventName,this._animationEnd):_.delay(this._animationEnd,b),this.contentCorner.x=this.globalWidth,this.deltaWidth<0&&(this.contentCorner.x-=this.deltaWidth/2)}this._render(!1,b)},b.prototype._startZoomRender=function(a){this._unbindDragEvent();var b=this.currentContentElement.getBoundingClientRect(),d=a.gesture.center.pageY-b.top,e=a.gesture.center.pageX-b.left;this.transformStore=c(this.currentContentElement.style[html5Lib.browserPrefix+"Transform"]),this.transformStore.accamulatedScale=1,html5Lib.transition(this.currentContentElement,0,"transform"),html5Lib.origin(this.currentContentElement,e,d),this.zoomWasRaised=!1,this.minZoom=bookModel.getRect(pageMediator.currentPage.id,1).pageHeight/this.currentContentElement.clientHeight,this.maxZoom=fbUtils.getMaxZoom(this.MAX_RESOLUTION,bookModel.getRect(pageMediator.currentPage.id).pageWidth,bookModel.getRect(pageMediator.currentPage.id).pageHeight),this.trigger("zoomAnimation:start")},b.prototype._zoomRender=function(a,b){b=b||0;var c=Math.max(a.gesture.scale,this.minZoom);c=Math.min(c,this.maxZoom);var d=this.transformStore.translate.x,e=this.transformStore.translate.y;if(c>1&&(this.zoomWasRaised=!0),b){html5Lib.transition(this.currentContentElement,b,"transform"),this.currentContentElement.style[html5Lib.browserPrefix+"TransitionTimingFunction"]="cubic-bezier(0.7, 0, 0.27, 1)";var f=this,g=function(){f._stopZoomRender.call(f,a),html5Lib.transEndEventName&&f.currentContainerElement.removeEventListener(html5Lib.transEndEventName,g),g=null};html5Lib.transEndEventName?this.currentContainerElement.addEventListener(html5Lib.transEndEventName,g):_.delay(g,b)}this.currentContentElement.style[html5Lib.browserPrefix+"Transform"]="translate3d("+d+"px,"+e+"px, 0px) scale("+c+")",this.transformStore.accamulatedScale=c},b.prototype._stopZoomRender=function(a){var b=this.currentContentElement.parentNode.getBoundingClientRect(),c=this.currentContentElement.getBoundingClientRect(),d=bookModel.zoomLevel,e=this;if(bookModel.setZoomLevel(c),d===bookModel.zoomLevel)return this.zoomWasRaised?void e.trigger("zoomAnimation:end"):void this.trigger("th:open");d<bookModel.zoomLevel?this.trigger("zoom:in","Book",pageMediator.currentPage.number):this.trigger("zoom:out","Book",pageMediator.currentPage.number);var f=Math.round(c.top-b.top),g=Math.round(c.left-b.left);this.currentContentObject.resize(!0),html5Lib.translate(this.currentContentObject.container,g,f),bookModel.zoomSave&&(e.leftContentObject.resize(),e.rightContentObject.resize()),setTimeout(function(){el.del(e.currentContentElement),e.currentContentElement=e.currentContentObject.container,e.trigger("zoomAnimation:end"),e.refresh.call(e,50)},150)},b.prototype._setStyles=function(a,b){a=a||0,b=b||"cubic-bezier(0,0,1,1)",html5Lib.transition(this.leftContainerElement,a,"transform"),html5Lib.transition(this.currentContainerElement,a,"transform"),html5Lib.transition(this.rightContainerElement,a,"transform"),html5Lib.transition(this.currentContentElement,a,"transform"),this.leftContainerElement.style[html5Lib.browserPrefix+"TransitionTimingFunction"]=b,this.currentContainerElement.style[html5Lib.browserPrefix+"TransitionTimingFunction"]=b,this.rightContainerElement.style[html5Lib.browserPrefix+"TransitionTimingFunction"]=b,this.currentContentElement.style[html5Lib.browserPrefix+"TransitionTimingFunction"]=b,html5Lib.translate(this.leftContainerElement,this.leftPageCorner.x,this.leftPageCorner.y),html5Lib.translate(this.currentContainerElement,this.currentPageCorner.x,this.currentPageCorner.y),html5Lib.translate(this.rightContainerElement,this.rightPageCorner.x,this.rightPageCorner.y),html5Lib.translate(this.currentContentElement,this.contentCorner.x,this.contentCorner.y)},b.prototype._setCorners=function(){var a=this.leftContentElement.clientWidth-this.globalWidth,b=this.rightContentElement.clientWidth-this.globalWidth,c=this.leftContentElement.clientHeight-this.globalHeight,d=this.rightContentElement.clientHeight-this.globalHeight,e=1;0>a?this.leftContentCorner.x+=a/2:this.leftContentCorner.x-=e,0>b?this.rightContentCorner.x-=b/2:this.rightContentCorner.x+=e,0>c?this.leftContentCorner.y-=c/2:this.leftContentCorner.y+=e,0>d?this.rightContentCorner.y-=d/2:this.rightContentCorner.y+=e,html5Lib.translate(this.leftContentElement,this.leftContentCorner.x,this.leftContentCorner.y),html5Lib.translate(this.rightContentElement,this.rightContentCorner.x,this.rightContentCorner.y)},b.prototype._initSizes=function(a){a=a||0,this.leftPageCorner.x=-this.globalWidth,this.rightPageCorner.x=this.globalWidth,this.deltaWidth=this.currentContentElement.clientWidth-this.globalWidth,this.deltaHeight=this.currentContentElement.clientHeight-this.globalHeight;var b=c(this.currentContentElement.style[html5Lib.browserPrefix+"Transform"]);this.contentCorner.x=b.translate.x,this.contentCorner.y=b.translate.y,b=null,0===this.contentCorner.x&&this.deltaWidth<0&&(this.contentCorner.x=-this.deltaWidth/2),this.leftContentCorner.x=-(this.leftContentElement.clientWidth-this.globalWidth),this.leftContentCorner.y=0,this.rightContentCorner.x=0,this.rightContentCorner.y=0,this.contentCornerStore.x=0,this.contentCornerStore.y=0,this.currentPageCornerStore.x=0,this.currentPageCornerStore.y=0,this._setCorners(),this._render(!1),this._stopRender(!1,a,"stop")},b.prototype._tapStart=function(){},b.prototype._tapMove=function(){},b.prototype._tapEnd=function(){},b.prototype._animationEnd=function(){},b.prototype._bindDom=function(a){a=a||0,this._bindDragEvent(),this._bindPinchEvent(),Hammer(this.currentContainerElement,{prevent_default:!0}).on("drag",function(){}),Hammer(this.mainContainer,{prevent_default:!0}).on("drag",function(){});var b=this;Hammer(this.currentContentElement,{prevent_default:!0}).on("release",function(){b._unbindDragEvent(),b._unbindPinchEvent(),b._bindDragEvent(),b._bindPinchEvent()}),this._initSizes(a)},b.prototype._bindDragEvent=function(){var a=this,b=!1;this._tapStart=function(c){if(!b){b=!0,a._unbindPinchEvent();var d={deltaX:c.gesture.deltaX,deltaY:c.gesture.deltaY};a._startRender.call(a,d),d=null}},this._tapMove=function(b){var c={deltaX:b.gesture.deltaX,deltaY:b.gesture.deltaY};a._render.call(a,c)},this._tapEnd=function(c){b=!1;var d={deltaX:c.gesture.deltaX,deltaY:c.gesture.deltaY};a._stopRender.call(a,d),d=null},this._swipeLeft=function(){"true"===a.currentContentElement.getAttribute("data-wide")&&a.currentContentElement.getBoundingClientRect().left>-(a.globalWidth/2)&&(a.contentCorner.x=a.currentContainerElement.getBoundingClientRect().width-a.currentContentElement.getBoundingClientRect().width)},this._swipeRight=function(){"true"===a.currentContentElement.getAttribute("data-wide")&&a.currentContentElement.getBoundingClientRect().left<a.globalWidth/2&&(a.contentCorner.x=0)},Hammer(this.currentContentElement,{prevent_default:!0,fb_lock_to_axis:!0,drag_block_vertical:1===bookModel.zoomLevel}).on("dragstart",this._tapStart),Hammer(this.currentContentElement,{prevent_default:!0,fb_lock_to_axis:!0,drag_block_vertical:1===bookModel.zoomLevel}).on("drag",this._tapMove),Hammer(this.currentContentElement,{prevent_default:!0,fb_lock_to_axis:!0,drag_block_vertical:1===bookModel.zoomLevel}).on("dragend",this._tapEnd),Hammer(this.currentContentElement,{prevent_default:!0}).on("swipeleft",this._swipeLeft),Hammer(this.currentContentElement,{prevent_default:!0}).on("swiperight",this._swipeRight)},b.prototype._unbindDragEvent=function(){Hammer(this.currentContentElement,{prevent_default:!0,fb_lock_to_axis:!0,drag_block_vertical:1===bookModel.zoomLevel}).off("dragstart",this._tapStart),Hammer(this.currentContentElement,{prevent_default:!0,fb_lock_to_axis:!0,drag_block_vertical:1===bookModel.zoomLevel}).off("drag",this._tapMove),Hammer(this.currentContentElement,{prevent_default:!0,fb_lock_to_axis:!0,drag_block_vertical:1===bookModel.zoomLevel}).off("dragend",this._tapEnd),Hammer(this.currentContentElement,{prevent_default:!0}).off("swipeleft",this._swipeLeft),Hammer(this.currentContentElement,{prevent_default:!0}).off("swiperight",this._swipeRight)},b.prototype._bindPinchEvent=function(){var a=this;this._pinchStart=function(b){a._startZoomRender(b)},this._pinchMove=function(b){a._zoomRender(b)},this._pinchEnd=function(b){a._stopZoomRender(b)},Hammer(this.currentContentElement,{prevent_default:!0}).on("transformstart",this._pinchStart),Hammer(this.currentContentElement,{prevent_default:!0}).on("pinch",this._pinchMove),Hammer(this.currentContentElement,{prevent_default:!0}).on("transformend",this._pinchEnd),this._doubletap=function(b){if(!a.zoomAnimationProcess){var c,d=a.currentContentElement.getBoundingClientRect(),e=b.gesture.center.pageY-d.top,f=b.gesture.center.pageX-d.left,g=a.currentContentObject.isBlock(f,e);if(g){var h={width:g.rect[2],height:g.rect[3],top:g.rect[1],left:g.rect[0]},i=device.screenWidth/h.width,j=Math.sqrt(this.MAX_RESOLUTION/(d.width*d.height));i>j&&(i=j);var k={width:h.width*i,height:h.height*i,top:(device.screenHeight-h.height*i)/2,left:(device.screenWidth-h.width*i)/2};c=a._correctionCenter(d,h,k),b.gesture.center.pageX=c.x,b.gesture.center.pageY=k.height<device.screenHeight?c.y:b.gesture.center.pageY,c=a._comeOutCorrection.call(a,b.gesture.center.pageX,b.gesture.center.pageY,i),b.gesture.center.pageX=c.x,b.gesture.center.pageY=c.y,a._startZoomRender(b),b.gesture.scale=i,a._zoomRender(b,300*(i/2))}else{if(bookModel.zoomLevel<1.05)c=a._comeOutCorrection.call(a,b.gesture.center.pageX,b.gesture.center.pageY,2),b.gesture.center.pageX=c.x,b.gesture.center.pageY=c.y,a._startZoomRender(b),b.gesture.scale=2;else{var l=bookModel.getRect(pageMediator.currentPage.id,1).pageHeight/a.currentContentElement.clientHeight;c=a._comeOutCorrection.call(a,b.gesture.center.pageX,b.gesture.center.pageY,l),b.gesture.center.pageX=c.x,b.gesture.center.pageY=c.y,a._startZoomRender(b),b.gesture.scale=l}a._zoomRender(b,300)}}},Hammer(this.currentContentElement,{prevent_default:!0}).on("doubletap",this._doubletap)},b.prototype._unbindPinchEvent=function(){Hammer(this.currentContentElement,{prevent_default:!0}).off("transformstart",this._pinchStart),Hammer(this.currentContentElement,{prevent_default:!0}).off("pinch",this._pinchMove),Hammer(this.currentContentElement,{prevent_default:!0}).off("transformend",this._pinchEnd),Hammer(this.currentContentElement,{prevent_default:!0}).off("doubletap",this._doubletap)},b.prototype._comeOutCorrection=function(a,b,c){var d,e,f=this.currentContentElement.getBoundingClientRect(),g={top:Math.round(f.top),left:Math.round(f.left),width:Math.round(f.width),height:Math.round(f.height)},h={left:0,top:0,width:g.width,height:g.height},i=b-g.top,j=a-g.left,k=j-j*c,l=i-i*c,m=g.left+k,n=g.top+l,o=g.width*c,p=g.height*c;d=o<device.screenWidth?(device.screenWidth-o)/2:m+o<device.screenWidth?device.screenWidth-o:m>0?0:m,e=p<device.screenHeight?(device.screenHeight-p)/2:n+p<device.screenHeight?device.screenHeight-p:n>0?0:n;var q={left:d,top:e,width:o,height:p};return this._correctionCenter(g,h,q)},b.prototype._correctionCenter=function(a,b,c){var d=a.left+b.left-c.left,e=c.left+c.width-(a.left+b.left+b.width),f=(d+e)/d,g=a.top+b.top-c.top,h=c.top+c.height-(a.top+b.top+b.height),i=(g+h)/g,j=b.left+a.left+b.width/f,k=b.top+a.top+b.height/i;return{x:j,y:k}},b.prototype._unbindDom=function(){html5Lib.transEndEventName&&this.currentContainerElement.removeEventListener(html5Lib.transEndEventName,this._animationEnd),this._unbindDragEvent(),this._unbindPinchEvent()},b.prototype._setContainerAs=function(a,b){this[b+"ContainerElement"]=this[a+"ContainerElement"],this[b+"ContentElement"]=this[a+"ContentElement"],this[b+"ContentObject"]=this[a+"ContentObject"]},b.prototype._goToLeft=function(){bookModel.resetZoomLevel(),this._unbindDom(),this.mainContainer.removeChild(this.leftContainerElement),this._setContainerAs("current","left"),this._setContainerAs("right","current"),this.leftContentObject.resize(),this._newWrapper("right"),this._bindDom()},b.prototype._goToRight=function(){bookModel.resetZoomLevel(),this._unbindDom(),this.mainContainer.removeChild(this.rightContainerElement),this._setContainerAs("current","right"),this._setContainerAs("left","current"),this.rightContentObject.resize(),this._newWrapper("left"),this._bindDom()},b.prototype._newWrapper=function(a){a=a||"right";var b=el.createElement("div",{"class":"wrapper"});this[a+"ContentObject"]=new ontent(b,a,"current"===a),"left"===a?this.mainContainer.insertBefore(b,this.mainContainer.getElementsByTagName("div")[0]):this.mainContainer.appendChild(b),this[a+"ContainerElement"]=b,this[a+"ContentElement"]=this[a+"ContentObject"].container},b.prototype.right=function(a){a="undefined"==typeof a?200:a+1,this._stopRender(!1,a,"right")},b.prototype.left=function(a){a="undefined"==typeof a?200:a+1,this._stopRender(!1,a,"left")},b.prototype.goToPage=function(a,b){if(b="undefined"==typeof b?200:b,a.number!=pageMediator.previousPage.number){if(bookModel.resetZoomLevel(),this.fireTrigger)return void(this.fireTrigger=!1);var c=function(a,b,c){this[a+"ContentObject"]=new ontent(this[a+"ContainerElement"],"current"),this[a+"ContentElement"]=this[a+"ContentObject"].container,this._initSizes.call(this,0),this.once("slideAnimation:end",function(){var b="left"===a?"right":"left";this[b+"ContentObject"]=new ontent(this[b+"ContainerElement"],b),this[b+"ContentElement"]=this[b+"ContentObject"].container,this._initSizes.call(this,0)},this)};a.number>parseInt(pageMediator.previousPage.number,10)?"rtl"===pageMediator.pagingType?(Math.abs(pageMediator.previousPage.number-a.number)>1&&c.call(this,"left",a,pageMediator.previousPage),this.right(b)):(Math.abs(pageMediator.previousPage.number-a.number)>1&&c.call(this,"right",a,pageMediator.previousPage),this.left(b)):a.number<pageMediator.previousPage.number&&("rtl"===pageMediator.pagingType?(Math.abs(pageMediator.previousPage.number-a.number)>1&&c.call(this,"right",a,pageMediator.previousPage),this.left(b)):(Math.abs(pageMediator.previousPage.number-a.number)>1&&c.call(this,"left",a,pageMediator.previousPage),this.right(b)))}},b.prototype.refresh=function(a){this.width=device.screenWidth,this.height=device.screenHeight,a=a||0,this.globalWidth=this.mainContainer.clientWidth,this.globalHeight=this.mainContainer.clientHeight,this.maxPullSize=this.globalWidth/7,this._unbindDom(),this._bindDom(a)};var c=function(a){function b(a){return parseInt(a.replace("px",""),10)}if("undefined"==typeof a)return d={},d.translate={x:0,y:0,z:0},d;var c=a.match(/[^(),\s]+/g),d={};if(null===c)return d.translate={x:0,y:0,z:0},d;for(var e=0,f=c.length;f>e;e++)switch(c[e]){case"translate":d.translate={x:b(c[e+1]),y:b(c[e+2]),z:0};break;case"translateX":d.translate={x:b(c[e+1]),y:0,z:0};break;case"translateY":d.translate={x:0,y:b(c[e+1]),z:0};break;case"translate3d":d.translate={x:b(c[e+1]),y:b(c[e+2]),z:b(c[e+3])};break;case"translateZ":d.translate={x:0,y:0,z:b(c[e+1])}}return d};a.Slide=b}(this),!function(a){"use strict";function b(a,b){this.x=a,this.y=b}function c(a){var c=this;this.wrapper=a,this.rect={width:window.innerWidth,height:window.innerHeight},this.activeSlide=0,this.slideCount=document.getElementsByClassName("smartSlidePage").length,this.position=new b(0,0),this.duration=0,this.disabled=!1,el.css(this.wrapper,{width:this.rect.width*this.slideCount+"px"}),this.on("slide:goTo",function(a){this._goTo(a)}),this.on("change:activeSlide",function(a){this._render(new b(-(a*this.rect.width),0),200)}),this.on("change:duration",this._setDuration,this),this.on("change:position",this._setPosition,this),this.on("change:rect",function(a){this.set("duration",0),this.set("position",new b(-this.activeSlide*a.width,0))}),this.on("slide:next",function(){this._goTo(this.activeSlide+1)}),this.on("slide:prev",function(){this._goTo(this.activeSlide-1)}),window.addEventListener("resize",function(){c.set("rect",{width:window.innerWidth,height:window.innerHeight}),el.css(c.wrapper,{width:c.rect.width*c.slideCount+"px"})});var d=function(a){c.trigger("slide:animationStart",c.activeSlide,c),c.startPosition=c.wrapper.getBoundingClientRect().left},e=function(a){0===c.activeSlide&&a.gesture.deltaX>=0||c.activeSlide-c.slideCount+1===0&&a.gesture.deltaX<=0||c._render(new b(c.startPosition+a.gesture.deltaX,0),0)},f=function(a){Math.abs(a.gesture.deltaX)<60?(c._render(new b(-(c.activeSlide*c.rect.width),0),50),c.trigger("slide:animationCancel",c.activeSlide,c)):c.trigger("slide:"+(a.gesture.deltaX>0?"prev":"next"),{},c)};this.startPosition=0,Hammer(this.wrapper,{prevent_default:!0}).on("dragstart",d),Hammer(this.wrapper,{prevent_default:!0}).on("drag",e),Hammer(this.wrapper,{prevent_default:!0}).on("dragend",f)}c.prototype=new Events,c.prototype.constructor=c,c.prototype._goTo=function(a){0>a||a>=this.slideCount||this.disabled||this.set("activeSlide",a)},c.prototype._render=function(a,b){this.disabled||(b=b||0,this.set("duration",b),this.set("position",a))},c.prototype._setDuration=function(a){html5Lib.duration(this.wrapper,a)},c.prototype._setPosition=function(a){html5Lib.translate(this.wrapper,a.x,a.y)},a.SmartSlide=c}(this),!function(a){function b(a){this.parent=a.windowEl,this.wrapper=el.createElement("div",{styles:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"}},this.parent),this.text={0:LOCALS.HELP_TEXT_0,1:LOCALS.HELP_TEXT_1,2:LOCALS.HELP_TEXT_2,3:LOCALS.HELP_TEXT_3,4:LOCALS.HELP_TEXT_4};for(var b=0,c=_.size(this.text);c>b;b++)this._renderSlide(b);this.slideObject=new SmartSlide(this.wrapper),this.slideObject.on("change:activeSlide",this._setActiveNavigation,this),this.slideObject.on("change:activeSlide",this._setText,this),this._renderNavigation(),this._setTitle()}b.prototype._renderSlide=function(a){var b=el.createElement("div",{"class":"smartSlidePage",styles:{"float":"left",width:window.innerWidth+"px","background-color":"#000",height:"100%"}},this.wrapper),c=el.createElement("div",{styles:{position:"absolute",width:window.innerWidth+"px",height:"60%",top:"20%","background-color":"#000","background-image":'url("'+STYLES_FOLDER+"/help/"+device.type+"/"+(1*a+1)+(1===fbUtils.getPixelRatio()?"":"-2x")+'.png")',"background-repeat":"no-repeat","background-size":"contain","background-position":"center center"}},b);window.addEventListener("resize",function(){el.css(b,{width:window.innerWidth+"px"}),el.css(c,{width:window.innerWidth+"px"})})},b.prototype._renderNavigation=function(){for(var a=el.createElement("div",{styles:{position:"fixed",top:"100%",left:"50%",width:34*this.slideObject.slideCount*fbUtils.getPixelRatio()+"px",height:14*fbUtils.getPixelRatio()+"px","z-index":"100","text-align":"center",margin:-(14*fbUtils.getPixelRatio())/2-40+"px 0px 0px "+34*-this.slideObject.slideCount*fbUtils.getPixelRatio()/2+"px"}},this.parent),b=this,c=0,d=this.slideObject.slideCount;d>c;c++){var e=el.createElement("div",{id:"navPoint"+c,"class":"navPoint",styles:{display:"inline-block","border-radius":"50%",width:9*fbUtils.getPixelRatio()+"px",height:9*fbUtils.getPixelRatio()+"px","background-color":"#333333",margin:"0px "+7*fbUtils.getPixelRatio()+"px"}},a);!function(a){Hammer(e,{prevent_default:!0}).on("tap",function(){b.slideObject.trigger("slide:goTo",a)})}(c)}this._setActiveNavigation();var f=el.createElement("span",{"class":"icon fb-icon-round-close helpClose"},this.parent);Hammer(f,{prevent_default:!0}).on("tap",function(){el.del(b.parent)})},b.prototype._setActiveNavigation=function(){for(var a=document.getElementsByClassName("navPoint"),b=0,c=a.length;c>b;b++)a[b].style.backgroundColor="#333333";el.css(el.id("navPoint"+this.slideObject.activeSlide),{"background-color":"#ffffff"})},b.prototype._setTitle=function(){var a=el.createElement("h3",{"class":"helpTitle"},this.parent);a.textContent=LOCALS.HELP_HOW_TO_USE.toUpperCase();var b=el.createElement("h4",{"class":"helpSubTitle"},this.parent);b.textContent=LOCALS.HELP_SCREEN,this.helpTextObject=el.createElement("span",{"class":"helpText"},this.parent),this._setText(0)},b.prototype._setText=function(a){html5Lib.animation(this.helpTextObject,"helpTextAni",500);var b=this;_.delay(function(){b.helpTextObject.textContent=b.text[a]},250),_.delay(function(){html5Lib.animation(b.helpTextObject,"",0)},500)},a.Help=b}(this),!function(a){"use strict";function b(){this._bind();var a=this;_.delay(function(){a._change.call(a)},0)}b.prototype=new Events,b.prototype.constructor=b,b.prototype._bind=function(){var b=this;Hammer(a,{}).on("hashchange",function(){b._change.call(b)})},b.prototype.cutEC=function(){this.route(pageMediator.currentPage)},b.prototype._change=function(){var a=this._getHash();if(""!==a){for(var b=a.split("/"),c=0,d=b.length;d>c;c++)""===b[c]&&b[c].splice(c,1);b[0]=parseInt(b[0],10),_.isNumber(b[0])&&!_.isNaN(b[0])?(b[0]<0||b[0]>pageTable.pageCount)&&(b[0]=pageMediator.currentPage.number):b[0]=pageMediator.currentPage.number,b[0]!==pageMediator.currentPage.number&&this.trigger("change:hash",b[0]),"undefined"!=typeof b[1]&&"z"!==b[1]&&this.trigger("product:show",b[1])}},b.prototype.route=function(b){a.location.hash=b.number},b.prototype._getHash=function(){var b=a.location.href.match(/#(.*)$/);return b?b[1]:""},a.Router=b}(this),!function(a){"use strict";function b(a){this.active=!1,this.wrapper=a.windowEl,this.body=el.createElement("div",{id:"searchBody","class":"searchBody"},this.wrapper),this.renderQueryInput(),this.on("query:enter",this.sendQuery,this),this.on("query:short",function(){this.renderNotify(),this.set("active",!0)},this),this.on("search:done",function(a){this.algorithm.result=[],this.renderResultTitle(a.length),this.renderResults(a),this.set("active",!0)},this),this.on("search:empty",function(){this.renderError(),this.set("active",!1)},this),this.on("query:clear",function(){this.renderNotify(),this.set("active",!1)},this),device.on("change:screenHeight",this._scrollerHeightTune,this),a.on("window:show",function(){var a=this;_.delay(function(){a.active||a.inp.focus()},500)},this),a.on("window:hide",function(){this.inp.blur()},this)}b.prototype=new Events,b.prototype.constructor=b,b.prototype.renderQueryInput=function(){var a=this,b=el.createElement("div",{"class":"queryInpWrapper"},this.wrapper,"top");this.inp=el.createElement("input",{type:"text","class":"queryInp"},b);var c=el.createElement("span",{"class":"queryEmpty"},b);Hammer(c,{prevent_default:!0}).on("tap",function(){event.stopPropagation(),a.trigger("query:clear"),a.inp.value=""}),Hammer(this.inp,{stop_browser_behavior:!1}).on("keydown",function(){13===event.keyCode&&this.blur()}),Hammer(this.inp,{stop_browser_behavior:!1}).on("blur",function(){window.scrollTo(0,0);var b=this.value.replace(" "," ");return this.value.length<publicationData.search.lim?void a.trigger("query:short",b):void a.trigger("query:enter",b)}),this.renderNotify()},b.prototype.sendQuery=function(a){var b=this,c=function(){var c=b.algorithm.go(a,JSON.parse(this.responseText).pages);0===c.length?b.trigger("search:empty"):b.trigger("search:done",c,a),c=null},d=new XMLHttpRequest;d.onload=c,d.onerror=function(){document.write("Error: can`t load xml3")};var e=function(a){d.open("GET",a),d.send(),d=null};changeUrlWhenPubl(ASSETS_FOLDER+"/search/searchtext.js",e)},b.prototype.renderNotify=function(){this.clear(),this.searchNotify=el.createElement("p",{"class":"searchNotify"},this.body),this.searchNotify.textContent=LOCALS.SEARCH_3SYMBOLS_NOTE.replace("3",publicationData.search.lim)},b.prototype.renderResultTitle=function(a){this.clear();var b=el.createElement("p",{"class":"searchResultTitle"},this.body);b.textContent=LOCALS.SEARCH_PAGE_NUMS+": "+a},b.prototype.renderError=function(){this.clear();var a=el.createElement("p",{"class":"searchNotify"},this.body);a.textContent=LOCALS.SEARCH_NO_RESULTS},b.prototype.clear=function(){"undefined"!=typeof this.iScroll&&this.iScroll.destroy(),el.clear(this.body)},b.prototype.renderResults=function(a){this.scroller=el.createElement("div",{styles:{position:"relative",overflow:"hidden"}},this.body);for(var b=el.createElement("ul",{"class":"searchResultsWrapper"},this.scroller),c=0,d=a.length;d>c;c++)this.injectResultItem(a[c],b);this._scrollerHeightTune(),this.iScroll=new IScroll(this.scroller)},b.prototype._scrollerHeightTune=function(){if("undefined"!=typeof this.scroller){var a=window.innerHeight-this.scroller.getBoundingClientRect().top;el.css(this.scroller,{height:a+"px"})}},b.prototype.injectResultItem=function(a,b){var c=el.createElement("li",{"class":"searchResultItem"},b),d=this,e=_.findWhere(pageTable,{id:a.page});Hammer(c,{prevent_default:!0}).on("tap",function(){event.stopPropagation(),d.trigger("change:page",e.number)}),this._addThumbnail(e.number,c);var f=el.createElement("h3",{},c);f.textContent=LOCALS.PAGE.toUpperCase()+" "+e.caption;var g=el.createElement("p",{},c);g.innerHTML=a.text},b.prototype._addThumbnail=function(a,b){var c={width:56*(fbUtils.getPixelRatio()||1),height:74*(fbUtils.getPixelRatio()||1)},d=bookModel.getRect(pageTable[a].id,void 0,c),e=el.createElement("div",{"class":"searchThumbnailWrapper",styles:{width:c.width+"px",height:c.height+"px",padding:(c.height-d.pageHeight)/2+"px "+(c.width-d.pageWidth)/2+"px","box-sizing":"border-box"}},b,"top"),f=el.createElement("div",{styles:{width:d.pageWidth+"px",height:d.pageHeight+"px","background-color":publicationData.getPageProperty(pageTable[a].id,"BGColor"),"background-size":d.contentWidth+"px "+d.contentHeight+"px","background-position":d.padding[1]+"px "+d.padding[0]+"px","background-repeat":"no-repeat"}},e),g=function(a){el.css(f,{"background-image":'url("'+a+'")'})};return changeUrlWhenPubl(publicationData.getThURL(pageTable[a].id),g),e},a.Search=b}(this),!function(a){"use strict";function b(a,b,c,d,e,f){this.page=a,this.text=b,this.relevant=c,this.startPos=d,this.stopPos=e,this.fullText=f}Search.prototype.algorithm={active:!1,result:[],pages:{},query:"",maxTextResultLength:90,getBold:function(a,b){var c=new RegExp(b,"ig"),d=function(a){return"<b>"+a+"</b>"};return a.replace(c,d)},buildSearchText:function(a,b,c){c=c||[];var d=b-this.maxTextResultLength/2;d=0>d?0:d;var e=a.substr(d,parseInt(this.maxTextResultLength)+6);if(e="..."+e+"...",e=fbUtils.screening(e),c.length>0)for(var f=0;f<c.length;f++)e=this.getBold(e,c[f]);else e=this.getBold(e,search.query);return e},buildIndexes:function(a,b,c){for(var d=[],e=0;b>e;e++){for(var f=[],g=a[e],h=-publicationData.search.lim;-1!=h;)h=c.indexOf(g,h+publicationData.search.lim),-1!=h&&f.push(h);f.length>0&&d.push(f)}return d},searchFullCoincidence:function(a,c,d,e){for(var f=-1,g=-1,h=c.toLowerCase();(f=h.indexOf(a,f+1))>=0;)if(g=f,-1!=f&&(0===f||fbUtils.isSplitter(h.charAt(f-1)))&&(f+a.length===h.length||fbUtils.isSplitter(h.charAt(f+a.length))))return this.result.push(new b(d,this.buildSearchText(c,f,[a]),e?0:1,f,f+a.length,e)),!0;return g>=0&&!publicationData.search.exactMatch?(this.result.push(new b(d,this.buildSearchText(c,g,[a]),e?2:3,g,g+a.length,e)),!0):(h=null,!1)},searchPartiallyCoincidence:function(a,c,d,e){var f=c.toLowerCase(),g=this.buildIndexes(a,e,f);if(null==g||0==g.length)return!1;for(var h=0,i=new Array(g.length),j=0;j<g.length;j++)i[j]=g[j][0];for(var k=0;k<g.length-1;k++){var l=1e3,m=g[k],n=g[k+1];if(null==m||null==n)break;for(var o=m.length,p=n.length,q=0;o>q;q++)for(var r=0;p>r;r++){var s=m[q],t=n[r],u=t>s?1:2,v=t>s?t-s:s-t,w=v*u;l>w&&(i[k]=s,i[k+1]=t,l=w)}h+=l}for(var x=1e4,y=0,z=0;null!=i&&z<i.length;z++)x=Math.min(x,i[z]),y=Math.max(y,i[z]);return h+=1e3*(e-g.length),f=null,this.result.push(new b(d,this.buildSearchText(c,x,a),h+4,x,y,!1)),!0},go:function(a,b){a=a.toLowerCase(),this.result=[],this.query=a;var c=fbUtils.split(a,publicationData.search.lim),d=c.length;for(var e in b.page){var f=b.page[e];null==f["#text"]||this.searchFullCoincidence(a,f["#text"],f["@ID"],!0)||publicationData.search.exactMatch||(d>1?this.searchPartiallyCoincidence(c,f["#text"],f["@ID"],d,a.length):1===d&&this.searchFullCoincidence(c[0],f["#text"],f["@ID"],!1))}return this.result.sort(this.sortFunc),this.result},sortFunc:function(a,b){
return a.page<b.page?-1:a.page>b.page?1:a.id<b.id?-1:a.id>b.id?1:0},clear:function(){this.query=""},stop:function(){this.active=!1,this.query="",this.result=[]}}}(this),!function(a){"use strict";function b(){if(this.toolbarVisible=!1,this.leftMenuVisible=!1,this.toolbarsAutoHideTimer=!1,pageMediator.on("change:page",function(){if(!this.toolbarsAutoHideTimer&&this.toolbarVisible){this.toolbarsAutoHideTimer=!0;var a=this;setTimeout(function(){a.toolbarsAutoHideTimer&&a.hideToolbar()},5e3)}},this),this.mainFlow=el.id("mainFlow"),this.bindToolbars(),this.bindWorkspaceEvents(),this.bindPager(),this.bindLeftMenu(),publicationData.visibility.share||PUBL&&APP_PROPERTIES.enabled?this.bindShareMenu():el.css(el.id("shareButton"),{display:"none"}),publicationData.visibility.search?this.bindSearchMenu():el.css(el.id("searchButton"),{display:"none"}),""!==shopId&&(a.currency=new Cart.prototype.Currency(publicationData.shopInfo.currency.formatString,publicationData.shopInfo.currency.accuracy,publicationData.shopInfo.currency.accuracySeparator,[3],publicationData.shopInfo.currency.exponentialSeparator,publicationData.shopInfo.hideZeroDecimals)),""!==shopId&&publicationData.shopInfo.usePublicationCart?(a.cartModel=new Cart,a.cartModel.setCurrency(publicationData.shopInfo.currency.code),"undefined"!=typeof universalAnalytics&&universalAnalytics.setShopName(publicationData.name),"undefined"!=typeof universalAnalytics&&(universalAnalytics.setCurrency(publicationData.shopInfo.currency.code),universalAnalytics.setShopName(publicationData.name)),this.bindCart()):el.css(el.id("cartButton"),{display:"none"}),this.bindThMenu(),this.bindHelpMenu(),publicationData.visibility.toc||publicationData.visibility.bookmarks){var b=el.createElement("div",{"class":"leftMenuWrapper"},document.body);el.createElement("ul",{"class":"leftMenu",id:"leftMenu"},b),this.iScrollLeftMenu=new IScroll(b),publicationData.visibility.toc?this.bindTOC():el.css(el.id("tocButton"),{display:"none"}),publicationData.visibility.bookmarks?this.bindBookmarks():el.css(el.id("bmButton"),{display:"none"}),this.on("leftMenu:show",this.showLeftMenu,this),this.on("leftMenu:hide",this.hideLeftMenu,this)}else el.css(el.id("tocButton"),{display:"none"}),el.css(el.id("bmButton"),{display:"none"});this.showToolbar()}b.prototype=new Events,b.prototype.constructor=b,b.prototype.bindToolbars=function(){this.topToolbar=el.id("topToolbar"),this.bottomToolbar=el.id("bottomToolbar")},b.prototype.bindWorkspaceEvents=function(){fbUtils.stopScroll(this.topToolbar),fbUtils.stopScroll(this.bottomToolbar),Hammer(this.topToolbar,{prevent_default:!0}).on("tap",function(a){a.stopPropagation()}),Hammer(this.bottomToolbar,{prevent_default:!0}).on("tap",function(a){a.stopPropagation()});var a=!1,b=this,c=function(a){return b.leftMenuVisible?void b.toggleLeftMenu():void b.toggleToolbar()};Hammer(el.id("mainFlow"),{prevent_default:!0,tap_always:!1}).on("tap doubletap",function(d){"doubletap"===d.type&&(a=!0),"tap"===d.type&&setTimeout(function(){return a?void(a=!1):(c.call(b,d),void(a=!1))},250)})},b.prototype.showToolbar=function(){this.toolbarVisible||(this.toolbarVisible=!0,html5Lib.duration(el.id("topToolbar"),250),html5Lib.delay(el.id("topToolbar"),250),html5Lib.translate(el.id("topToolbar")),html5Lib.duration(el.id("bottomToolbar"),250),html5Lib.delay(el.id("bottomToolbar"),0),html5Lib.translate(el.id("bottomToolbar")))},b.prototype.hideToolbar=function(){this.toolbarVisible&&(this.toolbarsAutoHideTimer=!1,this.toolbarVisible=!1,html5Lib.duration(el.id("topToolbar"),250),html5Lib.delay(el.id("topToolbar"),0),html5Lib.translate(el.id("topToolbar"),0,-(88*fbUtils.getPixelRatio())),html5Lib.duration(el.id("bottomToolbar"),250),html5Lib.delay(el.id("bottomToolbar"),250),html5Lib.translate(el.id("bottomToolbar"),0,88*fbUtils.getPixelRatio()))},b.prototype.toggleToolbar=function(){this.toolbarVisible?this.hideToolbar():this.showToolbar()},b.prototype.bindTOC=function(){this.toc=new TOC,this.toc.on("change:page",pageMediator.goToPage,pageMediator),this.toc.on("menu:close",this.toggleLeftMenu,this),this.toc.on("toc:subLevel",this.iScrollLeftMenu.refresh,this.iScrollLeftMenu),this.iScrollLeftMenu.refresh()},b.prototype.bindBookmarks=function(){this.bookmarks=new Bookmarks(el.id("bmButton")),this.bookmarks.on("change:page",pageMediator.goToPage,pageMediator),this.bookmarks.on("change:page",function(){this.toggleLeftMenu()},this),this.bookmarks.on("bookmark:first",this.toggleLeftMenu,this),this.bookmarks.on("bookmark:last",this.hideLeftMenu,this),this.on("leftMenu:hide",function(){this.set("settingsVisibility",!1)},this.bookmarks),this.on("leftMenu:show",this.iScrollLeftMenu.refresh,this.iScrollLeftMenu),this.bookmarks.on("bookmark:add bookmark:del",this.iScrollLeftMenu.refresh,this.iScrollLeftMenu),this.bookmarks.on("bookmark:add",function(a){this.trigger("bookmark:add",a,a)},this),this.bookmarks.on("bookmark:del",function(a){this.trigger("bookmark:del",a,a)},this)},b.prototype.bindPager=function(){this.pageCurrentLabel=el.id("currentPageLabel"),this.pageCountLabel=el.id("pageCountLabel"),this.pageCountLabel.textContent=pageMediator.pageCount;var a=function(a){this.pageCurrentLabel.textContent=a.caption};a.call(this,pageMediator.currentPage),pageMediator.on("change:page",a,this)},b.prototype.bindLeftMenu=function(){var a=this;Hammer(el.id("tocButton"),{prevent_default:!0}).on("tap",function(){a.toggleLeftMenu.call(a)}),this.on("change:leftMenuVisible",function(b){if(b){var c=el.createElement("div",{id:"blockerDiv",styles:{position:"absolute",width:"100%",height:"100%",zIndex:"1000000"}},"mainFlow","top");Hammer(c,{prevent_default:!0}).on("tap swipe",function(b){b.stopPropagation(),a.trigger("leftMenu:hide")})}else el.del("blockerDiv")},this)},b.prototype.showLeftMenu=function(){this.set("leftMenuVisible",!0),html5Lib.duration(this.mainFlow,250),a.innerWidth<300*fbUtils.getPixelRatio()?html5Lib.translate(this.mainFlow,"90%"):html5Lib.translate(this.mainFlow,300*fbUtils.getPixelRatio())},b.prototype.hideLeftMenu=function(){this.set("leftMenuVisible",!1),html5Lib.duration(this.mainFlow,250),html5Lib.translate(this.mainFlow)},b.prototype.toggleLeftMenu=function(){this.trigger(this.leftMenuVisible?"leftMenu:hide":"leftMenu:show")},b.prototype.showECProduct=function(a){this.trigger("product:open");var b=this.createWindow({name:publicationData.shopInfo.usePublicationCart?LOCALS.ADD_TO_CART.toUpperCase():LOCALS.EC_PRODUCT_INFO.toUpperCase(),animating:!1,position:"right",fullscreenTablet:!1,topToolbar:{size:"single",buttons:[{className:"icon fb-icon-back-close",closeButton:!0}]}});b.show.call(b),b.on("window:hide",function(){this.trigger("product:close"),this.trigger("ecProduct:hide")},this);var c=new ECProduct(a,b.windowEl);c.on("product:add product:checkout",b.hide,b),c.on("product:checkout",function(){this.trigger("checkout:product")},this)},b.prototype.bindCart=function(){var a=this,b=function(){0!==cartModel.length()?(el.removeClass(el.id("cartButton"),"fb-icon-empty-cart"),el.addClass(el.id("cartButton"),"fb-icon-full-cart")):(el.removeClass(el.id("cartButton"),"fb-icon-full-cart"),el.addClass(el.id("cartButton"),"fb-icon-empty-cart"))};b(),cartModel.on("change",b,a);var c=function(){if(0!==cartModel.length()){a.trigger("cart:open");var b=a.createWindow({name:LOCALS.CART.toUpperCase(),animating:!1,position:"right",fullscreenTablet:!1,topToolbar:{size:"single",buttons:[{className:"icon fb-icon-back-close",closeButton:!0}]}});b.show.call(b),b.on("window:hide",function(){a.trigger("cart:hide")},a);var c=new CartView(b.windowEl);c.on("cart:checkout",b.hide,b),c.on("cart:close",b.hide,b),c.on("cart:mail",a.bindSendMail,a)}};Hammer(el.id("cartButton"),{prevent_default:!0}).on("tap",c),this.on("checkout:product",c,this)},b.prototype.bindSendMail=function(){var a=this,b=a.createWindow({name:LOCALS.CONTACTS.toUpperCase(),animating:!1,position:"right",fullscreenTablet:!1,topToolbar:{size:"single",buttons:[{className:"icon fb-icon-back-close",closeButton:!0}]}});b.show.call(b);var c=new SendMailView(b.windowEl);c.on("mail:checkout",function(a){_.isString(a)&&(a=JSON.parse(a)),a.d.Success?(b.hide(),alert(LOCALS.EC_STATUS_TEXT)):alert("Error")},b)},b.prototype.bindThMenu=function(){var a=this,b=function(){a.trigger("th:open");var b=a.createWindow({name:LOCALS.THUMBNAILS.toUpperCase(),animating:!1,position:"right",fullscreenTablet:!0,topToolbar:{size:"single",buttons:[{className:"icon fb-icon-round-close",closeButton:!0}]}});b.show.call(b),b.on("window:hide",function(){a.trigger("th:close")});var c=new Thumbnails(b.windowEl);c.on("change:page",function(a){b.hide(),pageMediator.goToPage(a,0)},this)};this.on("th:openFromSlide",b,this),Hammer(el.id("thButton"),{prevent_default:!0}).on("tap",b)},b.prototype.bindShareMenu=function(){var a=this;Hammer(el.id("shareButton"),{prevent_default:!0}).on("tap",function(){if(a.trigger("share:open"),"tablet"!==device.type)new Share;else{var b=a.createWindow({name:LOCALS.SHARE.toUpperCase(),animating:!0,position:"right",fullscreenTablet:!1,topToolbar:{size:"single",buttons:[{className:"icon fb-icon-round-close",closeButton:!0}]}});b.on("window:hide",function(){a.trigger("share:close")},a),new Share(b.windowEl),_.defer(function(){b.show.call(b)})}})},b.prototype.bindSearchMenu=function(){var a=this;Hammer(el.id("searchButton"),{prevent_default:!0,stop_browser_behavior:!1}).on("tap",function(){if(a.trigger("search:open"),"undefined"==typeof a.searchWindow){a.searchWindow=a.createWindow({name:LOCALS.SEARCH.toUpperCase(),animating:!0,position:"right",keepOn:!0,fullscreenTablet:!0,topToolbar:{size:"single",buttons:[{className:"icon fb-icon-back-close",closeButton:!0}]}}),a.searchWindow.on("window:hide",function(){this.trigger("search:close")},a);var b=new Search(a.searchWindow);b.on("query:enter",function(a){this.trigger("search:text",a)},a),b.on("change:page",function(b){_.defer(function(){a.searchWindow.hide(),pageMediator.goToPage(b,0)})}),b.on("search:done",function(a,b){this.trigger("searchHighlight:on",b),this.searchActive=!0,this.searchQuery=b},a),b.on("query:short",function(){this.trigger("searchHighlight:off"),this.searchActive=!1,this.searchQuery=""},a),b.on("search:empty",function(){this.trigger("searchHighlight:off"),this.searchActive=!1,this.searchQuery=""},a),b.on("query:clear",function(){this.trigger("searchHighlight:off"),this.searchActive=!1,this.searchQuery=""},a)}_.defer(function(){a.searchWindow.show.call(a.searchWindow)})})},b.prototype.bindHelpMenu=function(){var a=this;Hammer(el.id("helpButton"),{prevent_default:!0}).on("tap",function(){var b=a.createWindow({name:LOCALS.HELP.toUpperCase(),animating:!1,position:"right",fullscreenTablet:!0});new Help(b),_.defer(function(){b.show.call(b)})})},a.Workspace=b}(this),!function(a){"use strict";function b(a){if(this.keepOn=a.keepOn||!1,this.animating="undefined"==typeof a.animating?!1:a.animating,this.position="undefined"==typeof a.position?"right":a.position,!a.fullscreenTablet&&device.screenWidth>=768*fbUtils.getPixelRatio()&&(this.animating=!1),this.fullscreenTablet=a.fullscreenTablet,this.injectBody(a.fullscreenTablet),"undefined"!=typeof a.topToolbar){var b=this.injectToolbar("top",a.topToolbar.size);"undefined"!=typeof a.name&&this.injectToolbarText(b,a.name),"undefined"!=typeof a.topToolbar.buttons&&_.each(a.topToolbar.buttons,function(a){this.injectButton(b,a)},this)}"undefined"!=typeof a.bottomToolbar&&(this.injectToolbar("bottom",a.bottomToolbar.size),"undefined"!=typeof a.bottomToolbar.buttons&&_.each(a.bottomToolbar.buttons,function(a){this.injectButton(b,a)},this)),"undefined"!=typeof a.topLabel&&this.injectLabel(a.topLabel.text,"top",a.topLabel.size),"undefined"!=typeof a.bottomLabel&&this.injectLabel(a.bottomLabel.text,"bottom",a.bottomLabel.size)}b.prototype=new Events,b.prototype.constructor=b,b.prototype.injectBody=function(a){if("undefined"==typeof a&&(a=!0),this.windowEl=el.createElement("div",{"class":"secondWindowBody"+(a?"":" tabletScreen")},document.body),html5Lib.duration(this.windowEl,0),html5Lib.translate(this.windowEl,"right"===this.position?window.innerWidth:-window.innerWidth),Hammer(this.windowEl,{prevent_default:!0}).on("drag",function(){}),!a){this.blackout=el.createElement("div",{"class":"secondWindowBodyBlack"},document.body),html5Lib.duration(this.blackout,0),html5Lib.translate(this.blackout,"right"===this.position?window.innerWidth:-window.innerWidth);var b=this;Hammer(this.blackout,{prevent_default:!0}).on("tap",function(){b.hide()})}},b.prototype.injectToolbar=function(a,b){a=a||"top",b=b||"single";var c=el.createElement("div",{"class":("top"===a?"secondWindowTopToolbar":"secondWindowBottomToolbar")+("single"===b?"":" secondWindowDoubleToolbar")},this.windowEl);return"top"===a?el.css(this.windowEl,{"padding-top":("single"===b?44:88)*fbUtils.getPixelRatio()+"px"}):el.css(this.windowEl,{"padding-bottom":("single"===b?44:88)*fbUtils.getPixelRatio()+"px"}),c},b.prototype.injectToolbarText=function(a,b){var c=el.createElement("h3",{"class":"topToolbarLabel"},a);c.textContent=b},b.prototype.injectLabel=function(a,b,c){b=b||"top",c=c||"single";var d=el.createElement("div",{"class":("top"===b?"secondWindowTopLabel":"secondWindowBottomLabel")+("single"===c?"":" secondWindowDoubleToolbar")},this.windowEl);return d.textContent=a,d},b.prototype.injectButton=function(a,b){var c=this,d=el.createElement("span",{"class":b.className},a);b.closeButton?Hammer(d,{prevent_default:!0}).on("tap",function(){c.hide.call(c)}):Hammer(d,{prevent_default:!0}).on("tap",function(){b.callback.call(c)})},b.prototype.hide=function(){if(!this.animating&&!this.keepOn)return this.destroy(),void this.trigger("window:hide");if("undefined"!=typeof this.blackout&&(html5Lib.duration(this.blackout,this.animating?250:0),html5Lib.translate(this.blackout,"right"===this.position?"100%":"-100%")),!this.fullscreenTablet&&device.screenWidth>768*fbUtils.getPixelRatio())return this.destroy(),void this.trigger("window:hide");if(a.device.platform.android&&!a.device.browser.chrome&&el.css(this.windowEl,{display:"none"}),html5Lib.duration(this.windowEl,this.animating?250:0),html5Lib.translate(this.windowEl,"right"===this.position?"100%":"-100%",0),html5Lib.duration(el.id("mainFlow"),this.animating?250:0),html5Lib.translate(el.id("mainFlow")),!this.keepOn){var b=this;_.delay(function(){b.destroy.call(b)},250)}this.trigger("window:hide")},b.prototype.show=function(){"undefined"!=typeof this.blackout&&(html5Lib.duration(this.blackout,this.animating?250:0),html5Lib.translate(this.blackout)),this.animating&&(a.device.platform.android&&!a.device.browser.chrome&&el.css(this.windowEl,{display:"block"}),html5Lib.duration(el.id("mainFlow"),this.animating?250:0),html5Lib.translate(el.id("mainFlow"),"right"===this.position?"-100%":"100%",0)),html5Lib.duration(this.windowEl,this.animating?250:0),html5Lib.translate(this.windowEl),this.trigger("window:show")},b.prototype.destroy=function(){el.del(this.windowEl),"undefined"!=typeof this.blackout&&el.del(this.blackout)},Workspace.prototype.createWindow=function(a){return new b(a)}}(this),!function(a){"use strict";function b(){this.render()}b.prototype=new Events,b.prototype.constructor=b,b.prototype.render=function(){if(!(publicationData.toc.length<1)){var a=el.id("leftMenu");Hammer(a,{prevent_default:!0}).on("tap",function(a){a.stopPropagation()});var b=el.createElement("li",{"class":"leftMenuTitle"},a);b.textContent=LOCALS.TOC.toUpperCase(),el.createElement("span",{"class":"icon fb-icon-toc-menu"},b);var c=this;_.each(publicationData.toc.children,function(b){var d=el.createElement("li",{"class":"leftMenuItem toc"},a),e=el.createElement("span",{"class":"tocSpan",styles:{"padding-left":16*fbUtils.getPixelRatio()+"px"}},d);e.innerHTML=b.name,"undefined"!=typeof b.children?(this.generateTOCSubLevel(b.children,d,2),Hammer(d,{prevent_default:!0}).on("tap",function(a){a.stopPropagation(),c.trigger("toc:subLevel",b.page)})):Hammer(d,{prevent_default:!0}).on("tap",function(a){a.stopPropagation(),c.trigger("change:page",b.page,0),c.trigger("menu:close",b.page)})},this)}},b.prototype.generateTOCSubLevel=function(a,b,c){var d=!1,e=el.createElement("span",{"class":"icon fb-icon-tr-left-menu"},b),f=el.createElement("ul",{"class":"leftMenuSubItemGroup toc"},b),g=function(){e.setAttribute("class","icon fb-icon-tr-down-menu"),el.css(f,{height:"auto"}),html5Lib.duration(f,250),d=!0},h=function(){e.setAttribute("class","icon fb-icon-tr-left-menu"),el.css(f,{height:"0"}),html5Lib.duration(f,250),d=!1},i=function(){d?h():g()};Hammer(b,{prevent_default:!0}).on("tap",function(){event.stopPropagation(),i()});var j=this;_.each(a,function(a){var b=el.createElement("li",{"class":"leftMenuSubItem toc"},f),d=el.createElement("span",{"class":"tocSpan",styles:{"padding-left":16*c*fbUtils.getPixelRatio()+"px"}},b);d.innerHTML=a.name,"undefined"!=typeof a.children?(this.generateTOCSubLevel(a.children,b,c+1),Hammer(b,{prevent_default:!0}).on("tap",function(b){b.stopPropagation(),j.trigger("toc:subLevel",a.page)})):Hammer(b,{prevent_default:!0}).on("tap",function(b){b.stopPropagation(),j.trigger("change:page",a.page,0),j.trigger("menu:close",a.page)})},this)},a.TOC=b}(this),!function(a){"use strict";function b(a){this.isFirstThumbnail=!0,this.thRect={width:device.screenWidth>=768*fbUtils.getPixelRatio()?110*fbUtils.getPixelRatio():84*fbUtils.getPixelRatio(),height:device.screenWidth>=768*fbUtils.getPixelRatio()?160*fbUtils.getPixelRatio():130*fbUtils.getPixelRatio()},this.wrapper=el.createElement("div",{"class":"thumbnailsWrapper",styles:{"padding-left":"0px","padding-right":"0px"}},a),this.scroller=el.createElement("div",{styles:{"float":"left"}},this.wrapper),this._calcPages(),_.each(this.pages,function(a,b){_.contains(a,pageMediator.currentPage.number)&&(this.currentPage=b)},this),this.loadedPages=[0,0],this.iScroll=new IScroll(this.wrapper),this._renderPage(this.currentPage-1,"top"),this._renderPage(this.currentPage),this._renderPage(this.currentPage+1),this.iScroll.scrollTo(0,0===this.currentPage?0:this.currentPage===this.pageCount-1?this.iScroll.maxScrollY:-this.pageHeight);var b=this;this.iScroll.on("scrollEnd",function(){if(b.iScroll.y===b.iScroll.maxScrollY)b._renderPage(b.loadedPages[1]+1);else if(0===b.iScroll.y){var a=b.loadedPages[0];b._renderPage(b.loadedPages[0]-1,"top"),b.loadedPages[0]!==a&&b.iScroll.scrollTo(0,-b.pageHeight)}})}b.prototype=new Events,b.prototype.constructor=b,b.prototype._calcPages=function(){var a=this._renderItem(pageTable[1],!0),b=a.getBoundingClientRect(),c=this.wrapper.getBoundingClientRect(),d=Math.floor(c.width/b.width),e=Math.floor(c.height/b.height),f=d*e;this.thMargin=(c.width-b.width*d)/(d+1),this.thMargin<20&&(d-=1,f=d*e,this.thMargin=(c.width-b.width*d)/(d+1)),this.pageHeight=e*b.height,this.pageCount=Math.ceil(publicationData.pageCount/f),el.del(a),a=null,this.pages=[];for(var g=1,h=0;h<this.pageCount;h++){this.pages[h]=[];for(var i=0;f>i&&!(g>pageTable.pageCount);)this.pages[h].push(g),pageTable[g].wide&&g%2!==0||i++,g++}},b.prototype._render=function(){_.forEach(pageTable,function(a,b){a.wide&&b%2!==0||this._renderItem(a)},this)},b.prototype._renderPagePreloader=function(a){a=a||"bottom";var b=el.createElement("div",{id:a+"PagePreloader",styles:{width:"100%",height:"64px","float":"left"}},this.scroller,a);el.createElement("img",{src:STYLES_FOLDER+"/preloader_2-3.gif",styles:{position:"absolute",top:"50%",left:"50%",margin:"-32px"}},b)},b.prototype._renderPage=function(a,b){if(!(0>a||a>=this.pageCount)){var c="top"===b?this.pages[a].reverse():this.pages[a];"top"===b?(this.loadedPages[0]=a,el.id("topPagePreloader")&&el.del("topPagePreloader")):(this.loadedPages[1]=a,el.id("bottomPagePreloader")&&el.del("bottomPagePreloader")),_.forEach(c,function(a){var c=pageTable[a];c.wide&&a%2!==0||this._renderItem(c,!1,b)},this),0!==a&&"top"===b?this._renderPagePreloader("top"):a!==this.pageCount-1&&"top"!==b&&this._renderPagePreloader(),this.iScroll.refresh()}},b.prototype._renderItem=function(a,b,c){if(b=b||!1,c=c||"bottom",_.isObject(a)){var d=bookModel.getRect(a.id,this.zoomFactor,this.thRect),e=this;this.isFirstThumbnail&&(this.thHeight=d.thPageHeight,this.isFirstThumbnail=!1);var f=el.createElement("div",{"class":"thumbnailsItem",styles:{"margin-left":this.thMargin+"px","margin-right":"0px"}},this.scroller,c);Hammer(f,{}).on("tap",function(){event.stopPropagation(),e.trigger("change:page",a.number)});var g=el.createElement("div",{styles:{width:d.thPageWidth+"px",height:(this.thHeight||d.thPageHeight)+"px","background-color":"rgb(56,57,59)",padding:d.thPadding[0]+"px "+d.thPadding[1]+"px","box-sizing":"padding-box"}},f);el.createElement("p",{"class":"thumbnailsItemName"},f).textContent=a.caption;var h=el.createElement("div",{styles:{width:d.pageWidth+"px",height:d.pageHeight+"px","background-color":"#FFF"}},g);if(a.id===pageMediator.currentPage.id&&el.createElement("div",{styles:{position:"relative",top:-(d.thPageHeight+4*fbUtils.getPixelRatio()-d.thPadding[0])+"px",left:-(4*fbUtils.getPixelRatio()+d.thPadding[1])+"px",width:d.thPageWidth+"px",height:d.thPageHeight+"px",border:4*fbUtils.getPixelRatio()+"px solid red","border-radius":4*fbUtils.getPixelRatio()+"px","box-sizing":"content-box"}},g),publicationData.page[a.id].stub||b)return f;var i=el.createElement("img",{src:STYLES_FOLDER+"/preloader_3.gif",styles:{position:"absolute",top:"50%",left:"50%",margin:"-32px"}},g),j=new Image;j.onload=function(){el.css(h,{background:'url("'+this.src+'") no-repeat',"background-color":publicationData.getPageProperty(a.id,"BGColor"),"background-size":d.contentWidth+"px "+d.contentHeight+"px","background-position":d.padding[1]+"px "+d.padding[0]+"px"}),el.del(i)};var k=function(a){j.src=a};changeUrlWhenPubl(publicationData.getThURL(a.id),k)}},a.Thumbnails=b}(this),!function(a){"use strict";function b(a){var b=this;this.button=a,this.bookmarks={},this.tocIconVisibility=!1,this.bmTitleVisibility=!1,this.settingsVisibility=!1,Modernizr.localstorage&&window.localStorage.getItem("bm"+publicationData.ident)&&(this.bookmarks=JSON.parse(window.localStorage.getItem("bm"+publicationData.ident))),Hammer(this.button,{}).on("tap",function(){b._toggleBookmark.call(b)}),0===_.size(this.bookmarks)&&(this.isFirst=!0),this.on("bookmark:add",this._addBookmark,this),this.on("bookmark:del",this._delBookmark,this),this.on("bookmark:add bookmark:del",this._save,this),this.on("bookmark:add bookmark:del",this._checkIconVisibility,this),this.on("bookmark:add bookmark:del",this._checkBMTitleVisibility,this),this.on("change:tocIconVisibility",this._toggleTOCIcon,this),this.on("change:bmTitleVisibility",this._toogleBookmarksTitle,this),this.on("change:settingsVisibility",this._toogleBookmarksSettings,this),pageMediator.on("change:page",this._applyButtonStyle,this),this._applyButtonStyle(),this._checkIconVisibility(),this._checkBMTitleVisibility(),this.on("bookmark:add",this._addBookmarkDOM,this),this.on("bookmark:del",this._delBookmarkDOM,this),_.size(this.bookmarks)>0&&(_.each(this.bookmarks,function(a,b){this._addBookmarkDOM(b)},this),el.css(el.id("tocButton"),{display:"block"}))}b.prototype=new Events,b.prototype.constructor=b,b.prototype._addBookmark=function(a){this.isFirst&&(this.trigger("bookmark:first"),this.isFirst=!1),this.bookmarks[a]=LOCALS.PAGE.toUpperCase()+" "+pageMediator.currentPage.caption,_.sortBy(this.bookmarks,function(a,b){return b}),this._applyButtonStyle()},b.prototype._delBookmark=function(a){delete this.bookmarks[a],this._applyButtonStyle(),0===_.size(this.bookmarks)&&this.trigger("bookmark:last","last")},b.prototype._toggleBookmark=function(){"undefined"==typeof this.bookmarks[pageMediator.currentPage.number]?this.trigger("bookmark:add",pageMediator.currentPage.number,this.bookmarks):this.trigger("bookmark:del",pageMediator.currentPage.number,this.bookmarks)},b.prototype._save=function(){Modernizr.localstorage&&window.localStorage.setItem("bm"+publicationData.ident,JSON.stringify(this.bookmarks))},b.prototype._applyButtonStyle=function(){"undefined"==typeof this.bookmarks[pageMediator.currentPage.number]?el.removeClass(this.button,"pressed"):el.addClass(this.button,"pressed")},b.prototype._checkIconVisibility=function(){publicationData.visibility.toc||0!==_.size(this.bookmarks)?this.set("tocIconVisibility",!0):this.set("tocIconVisibility",!1)},b.prototype._checkBMTitleVisibility=function(){0===_.size(this.bookmarks)?this.set("bmTitleVisibility",!1):this.set("bmTitleVisibility",!0)},b.prototype._toggleTOCIcon=function(a){el.css(el.id("tocButton"),{display:a?"block":"none"})},b.prototype._addBookmarksTitle=function(){var a=el.id("leftMenu");this.bookmarkWrapper=el.createElement("ul",{"class":"leftMenuBMUl",id:"bmBlock",styles:{"background-color":"#1d1e20"}},a,"top");var b=el.createElement("li",{"class":"leftMenuTitle",id:"bmTitle"},this.bookmarkWrapper);b.textContent=LOCALS.BOOKMARKS.toUpperCase(),el.createElement("span",{"class":"icon fb-icon-bm-menu"},b);var c=el.createElement("span",{"class":"icon fb-icon-settings-menu"},b),d=this;Hammer(c,{}).on("tap",function(){d.settingsVisibility?d.set("settingsVisibility",!1):d.set("settingsVisibility",!0)})},b.prototype._showBookmarksSettings=function(){for(var a=document.getElementsByClassName("bmItemTitle"),b=document.getElementsByClassName("fb-icon-bm-delete"),c=0,d=a.length;d>c;c++)html5Lib.duration(a[c],250),html5Lib.translate(a[c],55*fbUtils.getPixelRatio());for(c=0,d=b.length;d>c;c++)html5Lib.duration(b[c],250),el.css(b[c],{opacity:"1"})},b.prototype._hideBookmarksSettings=function(){for(var a=document.getElementsByClassName("bmItemTitle"),b=document.getElementsByClassName("fb-icon-bm-delete"),c=0,d=a.length;d>c;c++)html5Lib.duration(a[c],250),html5Lib.translate(a[c]);for(c=0,d=b.length;d>c;c++)html5Lib.duration(b[c],250),el.css(b[c],{opacity:"0"})},b.prototype._toogleBookmarksSettings=function(a){a?this._showBookmarksSettings():this._hideBookmarksSettings()},b.prototype._delBookmarksTitle=function(){el.del(el.id("bmBlock"))},b.prototype._toogleBookmarksTitle=function(a){a?this._addBookmarksTitle():this._delBookmarksTitle()},b.prototype._addBookmarkDOM=function(a){var b=el.createElement("li",{"class":"leftMenuItem bmMenuItem",id:"bm"+a},this.bookmarkWrapper),c=el.createElement("span",{"class":"icon fb-icon-bm-delete"},b),d=this;Hammer(c,{}).on("tap",function(){event.stopPropagation(),d.trigger("bookmark:del",a)});var e=el.createElement("span",{"class":"bmItemTitle"},b);e.textContent=this.bookmarks[a].toUpperCase(),this._addBMThumbnail(a,e),Hammer(b,{prevent_default:!0}).on("tap",function(b){b.stopPropagation(),d.trigger("change:page",a,0)})},b.prototype._addBMThumbnail=function(a,b){var c={width:56*fbUtils.getPixelRatio(),height:74*fbUtils.getPixelRatio()},d=bookModel.getRect(pageTable[a].id,void 0,c),e=el.createElement("div",{"class":"bmThumbnailWrapper",styles:{width:d.thPageWidth-2*d.thPadding[1]+"px",height:d.thPageHeight-2*d.thPadding[0]+"px",padding:d.thPadding[0]+"px "+d.thPadding[1]+"px",marginTop:(b.getBoundingClientRect().height-(d.thPageHeight-2*d.thPadding[0]))/2-3+"px","box-sizing":"content-box"}},b,"top");el.createElement("span",{"class":"redBookmark"},e);var f=el.createElement("div",{styles:{width:d.pageWidth+"px",height:d.pageHeight+"px","background-color":publicationData.getPageProperty(pageTable[a].id,"BGColor"),"background-size":d.contentWidth+"px "+d.contentHeight+"px","background-position":d.padding[1]+"px "+d.padding[0]+"px","background-repeat":"no-repeat"}},e),g=function(a){el.css(f,{"background-image":'url("'+a+'")'})};return changeUrlWhenPubl(publicationData.getThURL(pageTable[a].id),g),e},b.prototype._delBookmarkDOM=function(a){el.del(el.id("bm"+a))},a.Bookmarks=b}(this),!function(a){function b(a,b){this.bookmarks=a,pageMediator.on("change:page",this._applyButtonStyle,this),this._applyButtonStyle()}b.prototype._applyButtonStyle=function(){"undefined"==typeof this.bookmarks[pageMediator.currentPage.id]?el.removeClass(this.button,"pressed"):el.addClass(this.button,"pressed")},a.BookmarksView=b}(this),!function(a){"use strict";function b(a){if(this.url=window.location.href,!PUBL){var b=new RegExp("^(.*)(/"+FILES_FOLDER+"?).*(#.*)","i");this.url=this.url.replace(b,"$1/index.html$3")}var c=/(.*)#.*/.exec(this.url);this.url=null===c?this.url:c[1],this.url=encodeURIComponent(this.url),this.name=encodeURIComponent(publicationData.name),"undefined"==typeof a?this._renderMobile():(this.wrapper=a,this._render())}b.prototype=new Events,b.prototype.constructor=b,b.prototype._render=function(){var a=el.createElement("h2",{"class":"shareTitle"},this.wrapper);a.textContent=publicationData.name.toUpperCase(),this._addAPP(),publicationData.visibility.share&&(this.bottom=el.createElement("div",{"class":"shareBottom"},this.wrapper));var b=el.createElement("div",{"class":"sharePrev",styles:{height:this.wrapper.getBoundingClientRect().height-176*fbUtils.getPixelRatio()+"px"}},this.wrapper),c=function(a){el.css(b,{"background-repeat":"no-repeat","background-origin":"padding-box","background-position":"center center","background-size":"contain","background-image":'url("'+a+'")'})};changeUrlWhenPubl(publicationData.getImageURL(1),c),publicationData.visibility.share&&(this._addFacebook(),this._addTwitter(),this._addLinkedIn(),this._addTumblr(),this._addGoogle(),this._addEmail(),this._addVK())},b.prototype._addAPP=function(a){if(PUBL&&APP_PROPERTIES.enabled){a=a||"";var b=el.createElement("div",{"class":"appContainer "+a},this.wrapper);publicationData.visibility.share||""!==a?publicationData.visibility.share||""===a||el.css(b,{bottom:44*fbUtils.getPixelRatio()+"px"}):el.css(b,{bottom:"0px"}),el.createElement("img",{"class":"appIcon",src:APP_PROPERTIES.icon},b);var c=el.createElement("span",{"class":"appTitle"},b);c.textContent=LOCALS.OPEN_IN_APP,Hammer(b,{prevent_default:!0}).on("tap",function(){function a(a){return function(){var b=+new Date;setTimeout(function(){+new Date-b<2e3&&(window.location=a)},500)}}function b(a,b,c,d,e){if(!a||!b)return!1;var f=a+"="+encodeURIComponent(b);return f+="; path=/",c&&(f+="; expires="+c.toGMTString()),d&&(f+="; domain="+d),e&&(f+="; secure"),document.cookie=f,!0}if(APP_PROPERTIES.enabled)if(PUBL&&device.platform.ios&&device.platform.version[0]>=6){var c=APP_PROPERTIES.ios.url,d=APP_PROPERTIES.ios.protocol+":id="+properties.book;try{var e=new Date;e.setMonth(e.getMonth()+6),localStorage.setItem("bookID",properties.book),b("bookID",properties.book,e,"."+CLOUD_DOMAIN)}catch(f){console.log(f)}window.location=d,a(c)()}else PUBL&&device.platform.android&&device.device.version>3&&(window.location="http://"+CLOUD_DOMAIN+"/__android/"+APP_PROPERTIES.android["package"]+"/"+properties.book)})}},b.prototype._renderMobile=function(){var b=this,c=el.createElement("div",{id:"blockerDiv",styles:{position:"absolute",width:"100%",height:"100%",zIndex:"1000000"}},"mainFlow","top");if(Hammer(c,{prevent_default:!0}).on("tap",function(a){a.stopPropagation(),b._hideMobile.call(b)}),this.wrapper=el.createElement("div",{"class":"shareMobileWrapper"+(PUBL?" appNote":"")},document.body),publicationData.visibility.share||el.css(this.wrapper,{height:132*fbUtils.getPixelRatio()+"px",bottom:-(132*fbUtils.getPixelRatio())+"px"}),this._addAPP("mob"),publicationData.visibility.share){var d=el.createElement("div",{"class":"shareBottomScroller"+(device.browser.chrome&&device.browser.version<25?" preview":"")},this.wrapper);this.bottom=el.createElement("div",{"class":"shareBottomMobile"},d)}var e=el.createElement("div",{"class":"cancelShare"},this.wrapper);e.textContent=LOCALS.CANCEL,Hammer(e,{prevent_default:!0}).on("tap",function(){a.workspace.trigger("share:close"),b._hideMobile.call(b)}),publicationData.visibility.share&&(this._addFacebook(),this._addTwitter(),this._addLinkedIn(),this._addTumblr(),this._addGoogle(),this._addEmail(),this._addVK(),this.scroll=new IScroll(d,{scrollX:!0})),this._showMobile()},b.prototype._showMobile=function(){html5Lib.duration(this.wrapper,200),console.log(this.wrapper.getBoundingClientRect().height),html5Lib.translate(this.wrapper,0,-this.wrapper.getBoundingClientRect().height);

},b.prototype._hideMobile=function(){html5Lib.duration(this.wrapper,200),html5Lib.translate(this.wrapper);var a=this;el.del("blockerDiv"),_.delay(function(){el.del(a.wrapper)},200)},b.prototype._addFacebook=function(){var a=el.createElement("a",{href:"//m.facebook.com/sharer.php?u="+this.url.replace(encodeURIComponent("#"),encodeURIComponent("?p=")),"class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-facebook"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="FACEBOOK",this._linkReset(a,"facebook")},b.prototype._addTwitter=function(){var a=el.createElement("a",{href:"//twitter.com/intent/tweet?text="+this.name+"&url="+this.url,"class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-twitter"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="TWITTER",this._linkReset(a,"twitter")},b.prototype._addLinkedIn=function(){var a=el.createElement("a",{href:"//www.linkedin.com/shareArticle?mini=true&url="+this.url.replace(encodeURIComponent("#"),encodeURIComponent("?p="))+"&title="+this.name+"&summary="+this.name+"&source="+this.url.replace(encodeURIComponent("#"),encodeURIComponent("?p=")),"class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-linkedin"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="LINKED IN",this._linkReset(a,"linkedin")},b.prototype._addTumblr=function(){var a=el.createElement("a",{href:"//www.tumblr.com/share/link?url="+this.url+"&name="+this.name+"&description=","class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-tumblr"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="TUMBLR",this._linkReset(a,"tumblr")},b.prototype._addGoogle=function(){var a=el.createElement("a",{href:"//plus.google.com/share?url="+this.url,"class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-google"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="GOOGLE +",this._linkReset(a,"google")},b.prototype._addEmail=function(){var a=el.createElement("a",{href:"mailto:?subject="+this.name+"&body="+this.url,"class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-mail"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="E-MAIL",this._linkReset(a,"mail")},b.prototype._addVK=function(){var a=el.createElement("a",{href:"//vk.com/share.php?url="+this.url+"&title="+this.name+"&image="+ASSETS_FOLDER+"/thumb.jpg&description=","class":"shareItem"},this.bottom);el.createElement("span",{"class":"icon fb-icon-share-vk"},a),el.createElement("br",{},a);var b=el.createElement("span",{"class":"shareText"},a);b.textContent="VK",this._linkReset(a,"vk")},b.prototype._linkReset=function(b,c){Hammer(b,{prevent_default:!0}).on("tap",function(){a.workspace.trigger("share:"+c,b.href),b.click(),event.stopPropagation()}),Hammer(b,{prevent_default:!0}).on("touch release dragstart hold",function(){})},a.Share=b}(this),!function(a){function b(b){this.wrapper=b,this.total=0,this._render(),this.on("item:delete",function(b){return cartModel.delItem(b),0===cartModel.length()?void this.trigger("cart:close"):(el.del("wrapperItem"+b),void(el.id("totalCart").textContent=a.currency.Format(this._calcTotal())))},this),this.on("all:delete",function(){_.each(cartModel.getCart()[publicationId],function(a){cartModel.delItem(a.itemID)}),this.trigger("cart:close")},this),this.on("qty:plus qty:minus",function(b,c){0!==c&&(cartModel.changeQuantity(b,c),el.id("qty"+b).value=c,el.id("price"+b).textContent=a.currency.Format(productsBD[b].price*c),el.id("totalCart").textContent=a.currency.Format(this._calcTotal()))},this),this.on("cart:checkout",function(){for(var a in publicationData.shopInfo.providers);"demo"===a?window.confirm(LOCALS.EC_DEMO)&&(location.href="http://flippingbook.com/help/publisher-2/docs/quick-start/ecommerce-integration/?src=demo"):"mail"===a&&PUBL?this.trigger("cart:mail"):cartModel.checkout(cartModel.extend({type:a},publicationData.shopInfo),function(){},function(){})},this)}b.prototype=new Events,b.prototype.constructor=b,b.prototype._calcTotal=function(){this.total=0;var a=this;return _.each(cartModel.getCart()[publicationId],function(b){a.total+=b.qty*productsBD[b.itemID].price}),this.total},b.prototype._render=function(){var a=this;this.mainWindow=el.createElement("div",{"class":"ecProductMain"},this.wrapper);var b=el.createElement("a",{"class":"cartCheckoutButton"},this.mainWindow);b.textContent=LOCALS.EC_CHECKOUT.toUpperCase(),Hammer(b,{prevent_default:!0}).on("tap",function(){a.trigger("cart:checkout")}),this._renderInfo()},b.prototype._renderInfo=function(){var b=this,c=el.createElement("div",{"class":"productInfoWrapper"},this.mainWindow),d=el.createElement("div",{"class":"productInfoScroller"},c),e=cartModel.getCart()[publicationId];_.each(e,function(a){b._renderItem.call(b,a,d)});var f=el.createElement("div",{"class":"cartItemWrapper"},d),g=el.createElement("span",{"class":"cartItemName"},f);g.textContent=LOCALS.EC_TOTAL+":";var h=el.createElement("span",{"class":"icon fb-icon-bm-delete cartIco"},f);Hammer(h,{prevent_default:!0}).on("tap",function(){b.trigger("all:delete")});var i=el.createElement("span",{"class":"cartItemPrice",id:"totalCart"},f);i.textContent=a.currency.Format(this.total),this.iScroll=new IScroll(c)},b.prototype._renderItem=function(b,c){var d=this,e=el.createElement("div",{"class":"cartItemWrapper",id:"wrapperItem"+b.itemID},c);"undefined"!=typeof productsBD[b.itemID].media[0]&&el.createElement("img",{"class":"cartItemIMG",src:productsBD[b.itemID].media[0].url},e);var f=el.createElement("span",{"class":"cartItemName"},e);f.textContent=productsBD[b.itemID].name;var g=el.createElement("span",{"class":"icon fb-icon-bm-delete cartIco"},e);Hammer(g,{prevent_default:!0}).on("tap",function(){d.trigger("item:delete",b.itemID)});var h=el.createElement("span",{"class":"cartItemPrice",id:"price"+b.itemID},e);h.textContent=a.currency.Format(productsBD[b.itemID].price*b.qty),this.total+=productsBD[b.itemID].price*b.qty;var i=el.createElement("div",{"class":"cartQTYCtrl"},e),j=el.createElement("span",{"class":"cartQTYMinus"},i);j.textContent="",Hammer(j,{prevent_default:!0}).on("tap",function(){d.trigger("qty:minus",b.itemID,b.qty-1)}),el.createElement("input",{"class":"cartQTYInp",id:"qty"+b.itemID,value:b.qty},i);var k=el.createElement("span",{"class":"cartQTYPlus"},i);k.textContent="+",Hammer(k,{prevent_default:!0}).on("tap",function(){d.trigger("qty:plus",b.itemID,b.qty+1)})},a.CartView=b}(this),!function(a){function b(a){this.wrapper=a,this._render()}b.prototype=new Events,b.prototype.constructor=b,b.prototype._render=function(){var a=this;this.mainWindow=el.createElement("div",{"class":"ecProductMain"},this.wrapper);var b=el.createElement("a",{"class":"cartCheckoutButton"},this.mainWindow);b.textContent=LOCALS.EC_CHECKOUT.toUpperCase(),Hammer(b,{prevent_default:!0}).on("tap",function(){el.clear(a.errContainer);var b=!1;""===a.mail.value?(b=!0,a.mail.style.border="1px solid red",a._renderError(LOCALS.EC_ERROR_MAIL)):a.mail.style.border="1px solid #74787a";var c=/^[-._a-z0-9]+@(?:[a-z0-9][-a-z0-9]+\.)+[a-z]{2,6}$/i;c.test(a.mail.value)||""===a.mail.value?""!==a.mail.value&&(a.mail.style.border="1px solid #74787a"):(b=!0,a.mail.style.border="1px solid red",a._renderError(LOCALS.EC_WRONG_MAIL)),b?(Hammer(this.address,{stop_browser_behavior:!1}),Hammer(this.tel,{stop_browser_behavior:!1}),Hammer(this.mail,{stop_browser_behavior:!1}),Hammer(this.name,{stop_browser_behavior:!1})):a.trigger("cart:checkout",{name:a.name.value||"",mail:a.mail.value,phone:a.tel.value||"",address:a.address.value||""})}),this.on("cart:checkout",function(a){var b=cartModel.extend({type:"mail"},publicationData.shopInfo),c=this;cartModel.checkout(cartModel.extend(b,a),function(a){c.trigger("mail:checkout",a)},function(){})},this),this._renderInfo()},b.prototype._renderError=function(a){var b=el.createElement("p",{"class":"sendMailError"},this.errContainer);b.textContent=a,this.iScroll.refresh()},b.prototype._renderInfo=function(){var a=el.createElement("div",{"class":"productInfoWrapper"},this.mainWindow);this.scroller=el.createElement("div",{"class":"productInfoScroller"},a);var b=el.createElement("p",{"class":"sendMailText"},this.scroller);b.textContent=LOCALS.EC_MAIL_NOTE,c=el.createElement("div",{"class":"sendMailRow"},this.scroller),d=el.createElement("p",{"class":"sendMailTitle",styles:{color:"#000"}},c),d.textContent=LOCALS.EC_MAIL_MAIL+"*:",this.mail=el.createElement("input",{"class":"sendMailInput"},c);var c=el.createElement("div",{"class":"sendMailRow"},this.scroller),d=el.createElement("p",{"class":"sendMailTitle"},c);d.textContent=LOCALS.EC_MAIL_NAME+":",this.name=el.createElement("input",{type:"text","class":"sendMailInput"},c),c=el.createElement("div",{"class":"sendMailRow"},this.scroller),d=el.createElement("p",{"class":"sendMailTitle"},c),d.textContent=LOCALS.EC_MAIL_PHONE+":",this.tel=el.createElement("input",{"class":"sendMailInput"},c),c=el.createElement("div",{"class":"sendMailRow"},this.scroller),d=el.createElement("p",{"class":"sendMailTitle"},c),d.textContent=LOCALS.EC_MAIL_ADDRESS+":",this.address=el.createElement("textarea",{"class":"sendMailTextarea",rows:4},c),Hammer(this.address,{stop_browser_behavior:!1}),Hammer(this.tel,{stop_browser_behavior:!1}),Hammer(this.mail,{stop_browser_behavior:!1}),Hammer(this.name,{stop_browser_behavior:!1}),this.errContainer=el.createElement("div",{styles:{"float":"left"}},this.scroller),this.iScroll=new IScroll(a)},a.SendMailView=b}(this),!function(a){"use strict";function b(a,b){this.productID=a,this.wrapper=b,this.qty=1,this.on("qty:plus",function(){this.set("qty",1*this.qty+1)},this),this.on("qty:minus",function(){1!==this.qty&&this.set("qty",this.qty-1)},this),this.on("product:link",function(a){window.location=productsBD[a.id].url},this),this.on("product:add",function(a){cartModel.addItem(a.id,a.qty,{})},this),this.on("product:checkout",function(a){cartModel.addItem(a.id,a.qty,{}),el.id("cartButton").click()},this),"undefined"!=typeof universalAnalytics&&universalAnalytics.addImpression(productsBD[a].name,productsBD[a].sku),this._render()}b.prototype=new Events,b.prototype.constructor=b,b.prototype._render=function(){var a=this;if(this.mainWindow=el.createElement("div",{"class":"ecProductMain"},this.wrapper),publicationData.shopInfo.usePublicationCart){var b=el.createElement("a",{"class":"addButton"},this.mainWindow);b.textContent=LOCALS.EC_ADD_TO_CART.toUpperCase();var c=el.createElement("a",{"class":"checkoutButton"},this.mainWindow);c.textContent=LOCALS.EC_CHECKOUT.toUpperCase(),Hammer(b,{prevent_default:!0}).on("tap",function(){a.trigger("product:add",{id:a.productID,qty:a.qty})}),Hammer(c,{prevent_default:!0}).on("tap",function(){a.trigger("product:checkout",{id:a.productID,qty:a.qty})})}else{var d=el.createElement("a",{"class":"undefined"==typeof productsBD[a.productID].url?"cartCheckoutButton disabledCheck":"cartCheckoutButton"},this.mainWindow);if(d.textContent=LOCALS.EC_LINK.toUpperCase(),"undefined"==typeof productsBD[a.productID].url)return void this._renderInfo();Hammer(d,{prevent_default:!0}).on("tap",function(){a.trigger("product:link",{id:a.productID,qty:a.qty})})}this._renderInfo()},b.prototype._renderInfo=function(){var b=this,c=el.createElement("div",{"class":"productInfoWrapper"},this.mainWindow),d=el.createElement("div",{"class":"productInfoScroller"},c),e=el.createElement("div",{"class":"productTextWrapper","data-image":"undefined"!=typeof productsBD[this.productID].media[0]?"true":"false"},d),f=el.createElement("h2",{"class":"productTitle"},e);f.textContent=productsBD[this.productID].name;var g=el.createElement("span",{"class":"productSKU"},e);"undefined"!=typeof productsBD[this.productID].sku&&(g.textContent=LOCALS.EC_SKU.toUpperCase()+": "+productsBD[this.productID].sku);var h=el.createElement("span",{"class":"productPrice"},e);h.textContent=a.currency.Format(productsBD[this.productID].price);var i=el.createElement("span",{"class":"productDescription"},e);if("undefined"!=typeof productsBD[this.productID].description&&(i.textContent=productsBD[this.productID].description),publicationData.shopInfo.usePublicationCart){var j=el.createElement("div",{"class":"qtyCont"},d),k=el.createElement("p",{"class":"qtyLabel"},j);k.textContent=LOCALS.EC_QTY+":";var l=el.createElement("div",{"class":"qtyCtrl","data-image":"undefined"!=typeof productsBD[this.productID].media[0]?"true":"false"},j),m=el.createElement("span",{"class":"qtyMinus"},l);m.textContent="",Hammer(m,{prevent_default:!0}).on("tap",function(){b.trigger("qty:minus")});var n=el.createElement("input",{"class":"qtyInp",value:this.qty},l);this.on("change:qty",function(a){n.value=a});var o=el.createElement("span",{"class":"qtyPlus"},l);o.textContent="+",Hammer(o,{prevent_default:!0}).on("tap",function(){b.trigger("qty:plus")})}if("undefined"!=typeof productsBD[this.productID].media[0]){el.createElement("hr",{"class":"productHR","data-image":"undefined"!=typeof productsBD[this.productID].media[0]?"true":"false"},d);var p=el.createElement("div",{"class":"productImagesWrapper"},d),q=el.createElement("img",{"class":"productImage"},p);q.onload=function(){b.iScroll.refresh()},q.src=productsBD[this.productID].media[0].url}this.iScroll=new IScroll(c)},a.ECProduct=b}(this),!function(a){"use strict";var b=function(){a.renderDOM(),_.defer(function(){fbRequire.load([COMMON_FOLDER+"/ecommerce/cart"],function(){fbRequire.load([COMMON_FOLDER+"/ecommerce/products",LOCALS_FOLDER+"/"+device.lang+"/textlang"],function(){if(el.id("pageLabel").innerText=LOCALS.PAGE,!el.id("mainFrame")){if(el.createElement("div",{id:"mainFrame","class":"mainContainer"},"mainFlow"),PUBL&&(a.system=a.device,fbRequire.load([JAVASCRIPT_FOLDER+"/../../default/publNotify2"],function(){})),a.workspace=new Workspace,""!==shopId&&publicationData.shopInfo.usePublicationCart){var b=function(){var b=window.confirm(LOCALS.CLEAR_CART);b&&a.cartModel.clear(publicationId)};publicationData.shopInfo&&a.cartModel.getCheckoutStatus(b,publicationId)}var d=new Router;d.on("change:hash",pageMediator.goToPage,pageMediator),d.on("product:show",workspace.showECProduct,workspace),a.slider=new Slide,slider.on("th:open",function(){workspace.trigger("th:openFromSlide")}),workspace.on("ecProduct:hide",d.cutEC,d),pageMediator.on("change:page",d.route,slider),pageMediator.on("change:page",slider.goToPage,slider),"undefined"!=typeof universalAnalytics&&(a.workspace.on("publication:opened",universalAnalytics.publicationOpened,universalAnalytics),slider.on("zoom:out",universalAnalytics.zoomOut,universalAnalytics),slider.on("zoom:in",universalAnalytics.zoomIn,universalAnalytics),a.workspace.on("zoom:block",universalAnalytics.zoomBlock,universalAnalytics),pageMediator.on("change:page",function(a){universalAnalytics.openInSlide.call(universalAnalytics,"Book",a.number)},this),a.workspace.on("leftMenu:show",function(){universalAnalytics.openWindow.call(universalAnalytics,"TOC"),universalAnalytics.openWindow.call(universalAnalytics,"Bookmarks")}),a.workspace.on("leftMenu:hide",function(){universalAnalytics.closeWindow.call(universalAnalytics,"TOC"),universalAnalytics.closeWindow.call(universalAnalytics,"Bookmarks")}),a.workspace.on("bookmark:add",universalAnalytics.addBookmark,universalAnalytics),a.workspace.on("bookmark:del",universalAnalytics.removeBookmark,universalAnalytics),a.workspace.on("th:open",function(){universalAnalytics.openWindow.call(universalAnalytics,"Thumbnails")}),a.workspace.on("th:close",function(){universalAnalytics.closeWindow.call(universalAnalytics,"Thumbnails")}),a.workspace.on("share:open",function(){universalAnalytics.openWindow.call(universalAnalytics,"Share")}),a.workspace.on("share:close",function(){universalAnalytics.closeWindow.call(universalAnalytics,"Share")}),a.workspace.on("search:open",function(){universalAnalytics.openWindow.call(universalAnalytics,"Search")}),a.workspace.on("search:close",function(){universalAnalytics.closeWindow.call(universalAnalytics,"Search")}),a.workspace.on("search:text",universalAnalytics.search,universalAnalytics),a.workspace.on("cart:open",function(){universalAnalytics.openWindow.call(universalAnalytics,"Cart")}),a.workspace.on("cart:hide",function(){universalAnalytics.closeWindow.call(universalAnalytics,"Cart")}),a.workspace.on("product:open",function(){universalAnalytics.openWindow.call(universalAnalytics,"Product")}),a.workspace.on("product:close",function(){universalAnalytics.closeWindow.call(universalAnalytics,"Product")}),a.workspace.on("share:facebook",universalAnalytics.shareByFacebook,universalAnalytics),a.workspace.on("share:twitter",universalAnalytics.tweet,universalAnalytics),a.workspace.on("share:linkedin",universalAnalytics.shareByLinkedin,universalAnalytics),a.workspace.on("share:tumblr",universalAnalytics.shareByTumblr,universalAnalytics),a.workspace.on("share:vk",universalAnalytics.shareByVK,universalAnalytics),a.workspace.on("share:mail",universalAnalytics.shareByEmail,universalAnalytics),a.workspace.on("share:google",universalAnalytics.shareByGooglePlus,universalAnalytics)),_.delay(function(){c(),a.device.platform.ios&&1472===a.innerWidth&&a.scrollTo(0,1)},500)}})})})},c=function(){var b=el.id("splashScreen"),c=function(){html5Lib.transEndEventName&&b.removeEventListener(html5Lib.transEndEventName,c),el.del(b),b=null,c=null};html5Lib.transEndEventName?b.addEventListener(html5Lib.transEndEventName,c):_.delay(c,200),html5Lib.duration(b,200),html5Lib.translate(b,0,-device.screenHeight,0),a.workspace.trigger("publication:opened")};a.main=b,a.device.set("mainLoad",!0)}(this);var localPending=function(){};